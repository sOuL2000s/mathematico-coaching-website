<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MATHEMATICO - Special Mathematics Coaching</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom styles for the Inter font */
        body {
            font-family: 'Inter', sans-serif;
            overflow-x: hidden; /* Ensure no horizontal scrolling on the body */
        }
        html {
            overflow-x: hidden; /* Ensure no horizontal scrolling on the html element either */
            scroll-behavior: smooth;
        }
        /* Keyframe animation for fade-in-up effect */
        @keyframes fadeInUpp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        .animate-fade-in-up {
            animation: fadeInUpp 0.8s ease-out forwards;
        }
        .animate-fade-in-up.delay-200 {
            animation-delay: 0.2s;
        }
        /* For sticky header and anchor links */
        section {
            scroll-margin-top: 80px; /* Adjust this value based on your header's height */
        }

        /* Styles for the hamburger menu */
        .hamburger-menu {
            display: none; /* Hidden by default, shown on small screens */
        }
        @media (max-width: 767px) {
            .hamburger-menu {
                display: block;
            }
            .navbar-links {
                flex-direction: column;
                background-color: white; /* Default light mode background */
                position: absolute;
                top: 80px; /* Position directly below the header, assuming header height is 80px */
                left: 0; /* Align to the left edge of the viewport */
                width: 100vw; /* Span the full viewport width */
                padding: 1rem 0; /* Vertical padding */
                box-shadow: 0 8px 16px rgba(0,0,0,0.1);
                border-radius: 0 0 0.5rem 0.5rem;
                z-index: 60; /* Higher than sticky header */
                overflow: hidden; /* Hide overflow initially */
                max-height: 0; /* Start with 0 height for smooth transition */
                opacity: 0; /* Start with 0 opacity */
                visibility: hidden; /* Hidden by default */
                transition: max-height 0.3s ease-out, opacity 0.3s ease-out, visibility 0.3s ease-out; /* Smooth transition for height, opacity, and visibility */
                box-sizing: border-box; /* Include padding in the element's total width/height */
                display: flex; /* Keep flex for layout, but control visibility via other properties */
                pointer-events: none; /* Disable interaction when hidden */

                /* Dark mode styles for the mobile menu */
                .dark & { /* Apply these styles when html has 'dark' class */
                    background-color: #1f2937; /* dark-gray-800 */
                }
            }
            .navbar-links.active {
                max-height: 500px; /* Max height for the menu when active (adjust as needed) */
                opacity: 1; /* Fully visible */
                visibility: visible; /* Make visible */
                overflow-y: auto; /* Enable scrolling if content exceeds max-height */
                pointer-events: auto; /* Enable interaction when active */
            }
            .navbar-links li {
                width: 100%;
                text-align: center;
            }
            .navbar-links a {
                display: block;
                padding: 0.75rem 1rem; /* Consistent padding for links */
                color: #4b5563; /* Default light mode text color */
                /* Dark mode styles for menu links */
                .dark & { /* Apply these styles when html has 'dark' class */
                    color: #d1d5db; /* dark-gray-300 */
                }
            }
        }

        /* Accordion styles */
        .accordion-header {
            cursor: pointer;
            padding: 1.25rem;
            border-bottom: 1px solid #e5e7eb; /* gray-200 */
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out, padding 0.3s ease-out;
            padding: 0 1.25rem;
        }
        .accordion-content.active {
            max-height: 200px; /* Adjust as needed for content */
            padding: 1rem 1.25rem;
        }
        /* Style for scroll-to-top button */
        #scroll-to-top {
            display: none; /* Hidden by default */
            position: fixed;
            bottom: 1.5rem;
            right: 6rem; /* Adjusted right position to prevent overlap with WhatsApp CTA */
            z-index: 90; /* Lower z-index than WhatsApp CTA */
            background-color: #4f46e5; /* Indigo-600 */
            color: white;
            padding: 0.75rem;
            border-radius: 9999px; /* Full rounded */
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            transition: background-color 0.3s ease-in-out, transform 0.2s ease-in-out;
        }
        #scroll-to-top:hover {
            background-color: #4338ca; /* Indigo-700 */
            transform: scale(1.1);
        }

        /* Modal styles */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 100;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease-in-out, visibility 0.3s ease-in-out;
        }
        .modal.active {
            opacity: 1;
            visibility: visible;
        }
        .modal-content {
            background-color: white;
            padding: 2rem;
            border-radius: 0.75rem;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
            width: 90%;
            max-width: 600px; /* Increased max-width for iframe */
            height: 80%; /* Set a height for the iframe */
            max-height: 90vh; /* Limit height for scrollability */
            transform: translateY(20px);
            transition: transform 0.3s ease-in-out;
            position: relative;
            overflow: hidden; /* Hide overflow for the modal content itself */
        }
        .modal.active .modal-content {
            transform: translateY(0);
        }
        .modal-close-button {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #4b5563;
        }
        .dark .modal-content {
            background-color: #1f2937; /* dark-gray-800 */
            color: #d1d5db;
        }
        .dark .modal-close-button {
            color: #d1d5db;
        }
        .modal-content iframe {
            width: 100%;
            height: 100%;
            border: none;
        }

        /* WhatsApp CTA Z-index */
        .whatsapp-cta {
            z-index: 95; /* Higher z-index than scroll-to-top */
        }

        /* Loading Spinner */
        .spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            border-left-color: #4f46e5;
            animation: spin 1s ease infinite;
            display: inline-block;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Admin Mode Indicator */
        .admin-indicator {
            position: fixed;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            background-color: #ef4444; /* Red-500 */
            color: white;
            padding: 0.5rem 1rem;
            border-bottom-left-radius: 0.5rem;
            border-bottom-right-radius: 0.5rem;
            font-weight: bold;
            z-index: 100;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
            display: none; /* Hidden by default */
        }
        .admin-indicator.active {
            display: block;
        }
    </style>

    <!-- SEO Meta Tags -->
    <meta name="description" content="Best mathematics coaching for classes 9-12, IIT-JEE, Olympiads, and university level by Dipanjan Chatterjee.">
    <meta name="keywords" content="mathematics coaching, JEE, Olympiad, Barasat, Madhyamgram, Dipanjan Chatterjee, math tutor, Pure Maths">
    <meta name="author" content="Dipanjan Chatterjee">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://www.yourwebsite.com/"> <!-- Replace with your actual URL -->
    <meta property="og:title" content="MATHEMATICO - Special Mathematics Coaching by Dipanjan Chatterjee">
    <meta property="og:description" content="Comprehensive coaching for all boards, competitive exams, and higher studies by Dipanjan Chatterjee.">
    <meta property="og:image" content="https://www.yourwebsite.com/og-image.jpg"> <!-- Replace with your actual OG image -->

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://www.yourwebsite.com/"> <!-- Replace with your actual URL -->
    <meta property="twitter:title" content="MATHEMATICO - Special Mathematics Coaching by Dipanjan Chatterjee">
    <meta property="twitter:description" content="Comprehensive coaching for all boards, competitive exams, and higher studies by Dipanjan Chatterjee.">
    <meta property="twitter:image" content="https://www.yourwebsite.com/twitter-image.jpg"> <!-- Replace with your actual Twitter image -->

</head>
<body class="bg-gray-50 text-gray-800 transition-colors duration-300 ease-in-out">

    <!-- Admin Mode Indicator -->
    <div id="admin-mode-indicator" class="admin-indicator">
        ADMIN MODE
    </div>

    <header class="bg-white shadow-lg py-4 sticky top-0 z-50 rounded-b-lg
                   dark:bg-gray-900 dark:shadow-2xl transition-colors duration-300 ease-in-out">
        <div class="container mx-auto flex flex-col md:flex-row justify-between items-center relative px-6 md:px-12">
            <div class="flex items-center justify-between w-full md:w-auto mb-4 md:mb-0">
                <a href="#home" class="text-3xl font-extrabold text-indigo-700 flex items-center" aria-label="MATHEMATICO Home">
                   <svg class="w-8 h-8 mr-2 text-indigo-600" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm-1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l3 3a1 1 0 001.414-1.414L11 9.586V6a1 1 0 00-1-1z" clip-rule="evenodd"></path>
                    </svg>
                   MATHEMATICO
                </a>
                <!-- Hamburger Menu Button -->
                <button id="hamburger-button" class="md:hidden p-2 rounded-md text-gray-700 dark:text-gray-200 focus:outline-none focus:ring-2 focus:ring-indigo-500" aria-label="Toggle navigation menu">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                    </svg>
                </button>
            </div>
            <!-- Adjusted space-x for better fit -->
            <ul id="navbar-links" class="md:flex space-x-2 md:space-x-4 text-lg font-medium">
                <li><a href="#home" class="text-gray-600 hover:text-indigo-700 dark:text-gray-300 dark:hover:text-indigo-400 transition-colors duration-300 ease-in-out rounded-md px-2 py-2 hover:bg-indigo-50 dark:hover:bg-gray-700" aria-label="Go to Home section">Home</a></li>
                <li><a href="#about" class="text-gray-600 hover:text-indigo-700 dark:text-gray-300 dark:hover:text-indigo-400 transition-colors duration-300 ease-in-out rounded-md px-2 py-2 hover:bg-indigo-50 dark:hover:bg-gray-700" aria-label="Go to About Us section">About Us</a></li>
                <li><a href="#courses" class="text-gray-600 hover:text-indigo-700 dark:text-gray-300 dark:hover:text-indigo-400 transition-colors duration-300 ease-in-out rounded-md px-2 py-2 hover:bg-indigo-50 dark:hover:bg-gray-700" aria-label="Go to Courses section">Courses</a></li>
                <li><a href="#features" class="text-gray-600 hover:text-indigo-700 dark:text-gray-300 dark:hover:text-indigo-400 transition-colors duration-300 ease-in-out rounded-md px-2 py-2 hover:bg-indigo-50 dark:hover:bg-gray-700" aria-label="Go to Features section">Features</a></li>
                <!-- Updated navigation links for new pages -->
                <li><a href="#book-list-page" class="text-gray-600 hover:text-indigo-700 dark:text-gray-300 dark:hover:text-indigo-400 transition-colors duration-300 ease-in-out rounded-md px-2 py-2 hover:bg-indigo-50 dark:hover:bg-gray-700" aria-label="Go to Book List page">Book List</a></li>
                <li><a href="#problems-page" class="text-gray-600 hover:text-indigo-700 dark:text-gray-300 dark:hover:text-indigo-400 transition-colors duration-300 ease-in-out rounded-md px-2 py-2 hover:bg-indigo-50 dark:hover:bg-gray-700" aria-label="Go to Problems page">Problems</a></li>
                <li><a href="#gallery-page" class="text-gray-600 hover:text-indigo-700 dark:text-gray-300 dark:hover:text-indigo-400 transition-colors duration-300 ease-in-out rounded-md px-2 py-2 hover:bg-indigo-50 dark:hover:bg-gray-700" aria-label="Go to Gallery page">Gallery</a></li>
                <li><a href="#testimonials" class="text-gray-600 hover:text-indigo-700 dark:text-gray-300 dark:hover:text-indigo-400 transition-colors duration-300 ease-in-out rounded-md px-2 py-2 hover:bg-indigo-50 dark:hover:bg-gray-700" aria-label="Go to Testimonials section">Testimonials</a></li>
                <li><a href="#success-stories" class="text-gray-600 hover:text-indigo-700 dark:text-gray-300 dark:hover:text-indigo-400 transition-colors duration-300 ease-in-out rounded-md px-2 py-2 hover:bg-indigo-50 dark:hover:bg-gray-700" aria-label="Go to Success Stories section">Success Stories</a></li>
                <li><a href="#faq" class="text-gray-600 hover:text-indigo-700 dark:text-gray-300 dark:hover:text-indigo-400 transition-colors duration-300 ease-in-out rounded-md px-2 py-2 hover:bg-indigo-50 dark:hover:bg-gray-700" aria-label="Go to FAQ section">FAQ</a></li>
                <li><a href="#blog-page" class="text-gray-600 hover:text-indigo-700 dark:text-gray-300 dark:hover:text-indigo-400 transition-colors duration-300 ease-in-out rounded-md px-2 py-2 hover:bg-indigo-50 dark:hover:bg-gray-700" aria-label="Go to Blog section">Blog</a></li>
                <li><a href="#contact" class="text-gray-600 hover:text-indigo-700 dark:text-gray-300 dark:hover:text-indigo-400 transition-colors duration-300 ease-in-out rounded-md px-2 py-2 hover:bg-indigo-50 dark:hover:bg-gray-700" aria-label="Go to Contact section">Contact</a></li>
                <li><a href="#links" class="text-gray-600 hover:text-indigo-700 dark:text-gray-300 dark:hover:text-indigo-400 transition-colors duration-300 ease-in-out rounded-md px-2 py-2 hover:bg-indigo-50 dark:hover:bg-gray-700" aria-label="Go to Useful Links section">Links</a></li>
                <li><a href="#admin-page" class="text-gray-600 hover:text-indigo-700 dark:text-gray-300 dark:hover:text-indigo-400 transition-colors duration-300 ease-in-out rounded-md px-2 py-2 hover:bg-indigo-50 dark:hover:bg-gray-700" aria-label="Go to Admin section">Admin</a></li>
                <li>
                    <button id="theme-toggle" class="p-2 rounded-full bg-gray-200 text-gray-700 hover:bg-gray-300
                                         dark:bg-gray-700 dark:text-gray-200 dark:hover:bg-gray-600 transition-colors duration-300 ease-in-out focus:outline-none focus:ring-2 focus:ring-indigo-500" aria-label="Toggle theme">
                        <svg id="sun-icon" class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h1M3 12H2m8.003-9.997l-.707.707M16.997 16.997l.707.707M3.707 3.707l-.707.707m16.586 16.586l-.707-.707M12 7a5 5 0 100 10 5 5 0 000-10z"></path>
                        </svg>
                        <svg id="moon-icon" class="w-6 h-6 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 118.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path>
                        </svg>
                    </button>
                </li>
            </ul>
        </div>
    </header>

    <main id="main-content-container">
        <!-- Home Section -->
        <section id="home" class="page-section relative bg-gradient-to-r from-indigo-600 to-purple-700 text-white py-20 md:py-32 overflow-hidden rounded-b-lg shadow-xl">
            <div class="absolute inset-0 opacity-10">
                <svg class="w-full h-full" fill="currentColor" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid slice" xmlns="http://www.w3.org/2000/svg">
                    <pattern id="pattern-circles" x="0" y="0" width="10" height="10" patternUnits="userSpaceOnUse">
                        <circle cx="5" cy="5" r="2" fill="rgba(255,255,255,0.1)"></circle>
                    </pattern>
                    <rect x="0" y="0" width="100%" height="100%" fill="url(#pattern-circles)"></rect>
                </svg>
            </div>
            <div class="container mx-auto text-center relative z-10 px-4">
                <h1 class="text-4xl md:text-6xl font-extrabold leading-tight mb-6 animate-fade-in-up">
                    Special Mathematics Coaching by <br> Dipanjan Chatterjee <br> @ MATHEMATICO
                </h1>
                <p class="text-lg md:text-xl mb-10 max-w-3xl mx-auto opacity-90 animate-fade-in-up delay-200">
                    Comprehensive coaching for all boards, competitive exams, and higher studies.
                </p>
                <div class="flex flex-col sm:flex-row justify-center gap-4">
                    <a href="#courses" class="bg-white text-indigo-700 hover:bg-indigo-100 px-8 py-4 rounded-full text-lg font-semibold shadow-xl transform hover:scale-105 transition duration-300 ease-in-out" aria-label="Explore our courses">
                        Start Learning Today
                    </a>
                    <a href="#testimonials" class="bg-transparent border-2 border-white text-white hover:bg-white hover:text-indigo-700 px-8 py-4 rounded-full text-lg font-semibold shadow-xl transform hover:scale-105 transition duration-300 ease-in-out" aria-label="View student testimonials">
                        See Student Results
                    </a>
                </div>
            </div>
        </section>

        <!-- About Section -->
        <section id="about" class="page-section py-16 md:py-24 bg-white rounded-lg shadow-md mx-4 md:mx-auto max-w-6xl mt-8
                      dark:bg-gray-800 dark:shadow-xl transition-colors duration-300 ease-in-out">
            <div class="container mx-auto px-6 md:px-12 flex flex-col md:flex-row items-center gap-10">
                <div class="md:w-1/2">
                    <h2 class="text-4xl font-extrabold text-gray-900 mb-6 dark:text-gray-100 transition-colors duration-300 ease-in-out">About Dipanjan Chatterjee, M.Sc in Pure Maths</h2>
                    <p class="text-lg text-gray-700 leading-relaxed mb-6 dark:text-gray-300 transition-colors duration-300 ease-in-out">
                        At MATHEMATICO, we believe that every student has the potential to excel in mathematics. Our mission is to provide clear, concise, and engaging instruction that builds a strong foundation and fosters a deep understanding of mathematical concepts.
                    </p>
                    <p class="text-lg text-gray-700 leading-relaxed dark:text-gray-300 transition-colors duration-300 ease-in-out">
                        Led by Dipanjan Chatterjee, M.Sc in Pure Maths, our coaching center utilizes innovative teaching methods, personalized attention, and a supportive learning environment to help students overcome challenges and achieve their academic goals. We focus on conceptual clarity, problem-solving skills, and rigorous exam preparation.
                    </p>
                </div>
                <div class="md:w-1/2 flex justify-center">
                    <img src="ChatGPT Image Jul 8, 2025, 12_30_33 PM.png" alt="Portrait of Dipanjan Chatterjee, M.Sc in Pure Maths" class="rounded-xl shadow-2xl transform hover:scale-105 transition duration-500 ease-in-out w-full md:w-3/4 lg:w-2/3 h-auto object-cover" loading="lazy">
                </div>
            </div>
        </section>

        <!-- Courses Section -->
        <section id="courses" class="page-section py-16 md:py-24 bg-gray-100 rounded-lg shadow-md mx-4 md:mx-auto max-w-6xl mt-8
                       dark:bg-gray-950 dark:shadow-xl transition-colors duration-300 ease-in-out">
            <div class="container mx-auto px-6 md:px-12 text-center">
                <h2 class="text-4xl font-extrabold text-gray-900 mb-12 dark:text-gray-100 transition-colors duration-300 ease-in-out">Our Comprehensive Courses</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                    <div class="bg-white p-8 rounded-xl shadow-lg hover:shadow-xl transform hover:scale-105 transition duration-300 ease-in-out flex flex-col items-center text-center
                                dark:bg-gray-800 dark:shadow-2xl transition-colors duration-300 ease-in-out">
                        <div class="text-indigo-600 mb-4">
                            <svg class="w-12 h-12" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path></svg>
                        </div>
                        <h3 class="text-2xl font-bold text-gray-900 mb-4 dark:text-gray-100 transition-colors duration-300 ease-in-out">Classes 9-12 (All Boards)</h3>
                        <p class="text-gray-600 mb-6 dark:text-gray-300 transition-colors duration-300 ease-in-out">
                            Comprehensive coaching for students from class 9 to 12, covering all major educational boards. Strong foundation and advanced concepts.
                        </p>
                        <button class="bg-indigo-600 text-white px-6 py-3 rounded-full text-md font-semibold hover:bg-indigo-700 transition duration-300 ease-in-out enroll-button" data-course="Classes 9-12 (All Boards)" aria-label="Enroll in Classes 9-12 course">Enroll Now</button>
                    </div>

                    <div class="bg-white p-8 rounded-xl shadow-lg hover:shadow-xl transform hover:scale-105 transition duration-300 ease-in-out flex flex-col items-center text-center
                                 dark:bg-gray-800 dark:shadow-2xl transition-colors duration-300 ease-in-out">
                        <div class="text-indigo-600 mb-4">
                            <svg class="w-12 h-12" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"></path></svg>
                        </div>
                        <h3 class="text-2xl font-bold text-gray-900 mb-4 dark:text-gray-100 transition-colors duration-300 ease-in-out">IIT Foundation & Olympiad</h3>
                        <p class="text-gray-600 mb-6 dark:text-gray-300 transition-colors duration-300 ease-in-out">
                            Specialized programs for IIT Foundation and various Mathematics Olympiads, including IOQM, RMO (Regional Maths Olympiad), building competitive skills from an early age.
                        </p>
                        <button class="bg-indigo-600 text-white px-6 py-3 rounded-full text-md font-semibold hover:bg-indigo-700 transition duration-300 ease-in-out enroll-button" data-course="IIT Foundation & Olympiad" aria-label="Enroll in IIT Foundation & Olympiad course">Enroll Now</button>
                    </div>

                    <div class="bg-white p-8 rounded-xl shadow-lg hover:shadow-xl transform hover:scale-105 transition duration-300 ease-in-out flex flex-col items-center text-center
                                 dark:bg-gray-800 dark:shadow-2xl transition-colors duration-300 ease-in-out">
                        <div class="text-indigo-600 mb-4">
                            <svg class="w-12 h-12" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 12l3-3 3 3 4-4M8 21l4-4 4 4M3 5h18M4 12h16M4 18h16"></path></svg>
                        </div>
                        <h3 class="text-2xl font-bold text-gray-900 mb-4 dark:text-gray-100 transition-colors duration-300 ease-in-out">Competitive Entrance Exams</h3>
                        <p class="text-gray-600 mb-6 dark:text-gray-300 transition-colors duration-300 ease-in-out">
                            Targeted preparation for JEE (Mains/Advanced), WBJEE, ISI B-Stat/B-Math Entrance, and other engineering/statistics entrances.
                        </p>
                        <button class="bg-indigo-600 text-white px-6 py-3 rounded-full text-md font-semibold hover:bg-indigo-700 transition duration-300 ease-in-out enroll-button" data-course="Competitive Entrance Exams" aria-label="Enroll in Competitive Entrance Exams course">Enroll Now</button>
                    </div>

                    <div class="bg-white p-8 rounded-xl shadow-lg hover:shadow-xl transform hover:scale-105 transition duration-300 ease-in-out flex flex-col items-center text-center
                                 dark:bg-gray-800 dark:shadow-2xl transition-colors duration-300 ease-in-out">
                        <div class="text-indigo-600 mb-4">
                            <svg class="w-12 h-12" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path></svg>
                        </div>
                        <h3 class="text-2xl font-bold text-gray-900 mb-4 dark:text-gray-100 transition-colors duration-300 ease-in-out">B.Sc (Hons/Pass) All Universities</h3>
                        <p class="text-gray-600 mb-6 dark:text-gray-300 transition-colors duration-300 ease-in-out">
                            Support for B.Sc (Honours/Pass) mathematics students across all university syllabi, focusing on core concepts and advanced topics.
                        </p>
                        <button class="bg-indigo-600 text-white px-6 py-3 rounded-full text-md font-semibold hover:bg-indigo-700 transition duration-300 ease-in-out enroll-button" data-course="B.Sc (Hons/Pass) All Universities" aria-label="Enroll in B.Sc course">Enroll Now</button>
                    </div>

                    <div class="bg-white p-8 rounded-xl shadow-lg hover:shadow-xl transform hover:scale-105 transition duration-300 ease-in-out flex flex-col items-center text-center
                                 dark:bg-gray-800 dark:shadow-2xl transition-colors duration-300 ease-in-out">
                        <div class="text-indigo-600 mb-4">
                            <svg class="w-12 h-12" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 14v3m4-3v3m4-3v3M3 21h18M3 10h18M3 7l9-4 9 4M4 10h16v11H4V10z"></path></svg>
                        </div>
                        <h3 class="text-2xl font-bold text-gray-900 mb-4 dark:text-gray-100 transition-colors duration-300 ease-in-out">B.Tech, GATE & Other Exams</h3>
                        <p class="text-gray-600 mb-6 dark:text-gray-300 transition-colors duration-300 ease-in-out">
                            Coaching for B.Tech mathematics, GATE, and other engineering-related mathematics examinations.
                        </p>
                        <button class="bg-indigo-600 text-white px-6 py-3 rounded-full text-md font-semibold hover:bg-indigo-700 transition duration-300 ease-in-out enroll-button" data-course="B.Tech, GATE & Other Exams" aria-label="Enroll in B.Tech & GATE course">Enroll Now</button>
                    </div>

                    <div class="bg-white p-8 rounded-xl shadow-lg hover:shadow-xl transform hover:scale-105 transition duration-300 ease-in-out flex flex-col items-center text-center
                                 dark:bg-gray-800 dark:shadow-2xl transition-colors duration-300 ease-in-out">
                        <div class="text-indigo-600 mb-4">
                            <svg class="w-12 h-12" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                        </div>
                        <h3 class="text-2xl font-bold text-gray-900 mb-4 dark:text-gray-100 transition-colors duration-300 ease-in-out">General Math Support</h3>
                        <p class="text-gray-600 mb-6 dark:text-gray-300 transition-colors duration-300 ease-in-out">
                            Flexible support for various other mathematical needs, including doubt clearing and specific topic mastery.
                        </p>
                        <button class="bg-indigo-600 text-white px-6 py-3 rounded-full text-md font-semibold hover:bg-indigo-700 transition duration-300 ease-in-out enroll-button" data-course="General Math Support" aria-label="Learn more about General Math Support">Learn More</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Features Section -->
        <section id="features" class="page-section py-16 md:py-24 bg-white rounded-lg shadow-md mx-4 md:mx-auto max-w-6xl mt-8
                   dark:bg-gray-800 dark:shadow-xl transition-colors duration-300 ease-in-out">
            <div class="container mx-auto px-6 md:px-12 text-center">
                <h2 class="text-4xl font-extrabold text-gray-900 mb-12 dark:text-gray-100 transition-colors duration-300 ease-in-out">Why Choose MATHEMATICO?</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-10">
                    <div class="flex flex-col items-center p-6 rounded-xl shadow-md hover:shadow-lg transition duration-300 ease-in-out bg-indigo-50
                                dark:bg-gray-700 dark:shadow-2xl transition-colors duration-300 ease-in-out">
                        <div class="text-indigo-600 mb-4">
                            <svg class="w-12 h-12" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H2v-2a4 4 0 014-4h12.356"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 12v-1a4 4 0 014-4h2a4 4 0 014 4v1m-6 0h.01M6 16h.01"></path></svg>
                        </div>
                        <h3 class="text-xl font-bold text-gray-900 mb-3 dark:text-gray-100 transition-colors duration-300 ease-in-out">Experienced Educator</h3>
                        <p class="text-gray-600 dark:text-gray-300 transition-colors duration-300 ease-in-out">
                            Learn from Dipanjan Chatterjee, M.Sc in Pure Maths, a highly qualified and passionate teacher.
                        </p>
                    </div>
                    <div class="flex flex-col items-center p-6 rounded-xl shadow-md hover:shadow-lg transition duration-300 ease-in-out bg-indigo-50
                                dark:bg-gray-700 dark:shadow-2xl transition-colors duration-300 ease-in-out">
                        <div class="text-indigo-600 mb-4">
                            <svg class="w-12 h-12" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 14v3m4-3v3m4-3v3M3 21h18M3 10h18M3 7l9-4 9 4M4 10h16v11H4V10z"></path></svg>
                        </div>
                        <h3 class="text-xl font-bold text-gray-900 mb-3 dark:text-gray-100 transition-colors duration-300 ease-in-out">Personalized Attention</h3>
                        <p class="text-gray-600 dark:text-gray-300 transition-colors duration-300 ease-in-out">
                            Small batch sizes ensure individual focus and tailored guidance for every student.
                        </p>
                    </div>
                    <div class="flex flex-col items-center p-6 rounded-xl shadow-md hover:shadow-lg transition duration-300 ease-in-out bg-indigo-50
                                dark:bg-gray-700 dark:shadow-2xl transition-colors duration-300 ease-in-out">
                        <div class="text-indigo-600 mb-4">
                            <svg class="w-12 h-12" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path></svg>
                        </div>
                        <h3 class="text-xl font-bold text-gray-900 mb-3 dark:text-gray-100 transition-colors duration-300 ease-in-out">Comprehensive Curriculum</h3>
                        <p class="text-gray-600 dark:text-gray-300 transition-colors duration-300 ease-in-out">
                            Well-structured curriculum covering all essential topics for various boards and exams.
                        </p>
                    </div>
                    <div class="flex flex-col items-center p-6 rounded-xl shadow-md hover:shadow-lg transition duration-300 ease-in-out bg-indigo-50
                                dark:bg-gray-700 dark:shadow-2xl transition-colors duration-300 ease-in-out">
                        <div class="text-indigo-600 mb-4">
                            <svg class="w-12 h-12" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v2m-3-2v2m-3-2v2m9-2v2m-3-2v2m-3-2v2M9 10V7m-3 3V7m-3 3V7m9 3V7m-3 3V7m-3 3V7M3 4h18V3H3v1zm0 16h18v-1H3v1zm0-4h18v-1H3v1zm0-4h18v-1H3v1zm0-4h18V7H3v1z"></path></svg>
                        </div>
                        <h3 class="text-xl font-bold text-gray-900 mb-3 dark:text-gray-100 transition-colors duration-300 ease-in-out">Regular Assessments</h3>
                        <p class="text-gray-600 dark:text-gray-300 transition-colors duration-300 ease-in-out">
                            Frequent tests and quizzes to track progress and identify areas for improvement.
                        </p>
                    </div>
                    <div class="flex flex-col items-center p-6 rounded-xl shadow-md hover:shadow-lg transition duration-300 ease-in-out bg-indigo-50
                                dark:bg-gray-700 dark:shadow-2xl transition-colors duration-300 ease-in-out">
                        <div class="text-indigo-600 mb-4">
                            <svg class="w-12 h-12" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                        </div>
                        <h3 class="text-xl font-bold text-gray-900 mb-3 dark:text-gray-100 transition-colors duration-300 ease-in-out">Flexible Timings</h3>
                        <p class="text-gray-600 dark:text-gray-300 transition-colors duration-300 ease-in-out">
                            Options for various batch timings to suit different student schedules.
                        </p>
                    </div>
                    <div class="flex flex-col items-center p-6 rounded-xl shadow-md hover:shadow-lg transition duration-300 ease-in-out bg-indigo-50
                                dark:bg-gray-700 dark:shadow-2xl transition-colors duration-300 ease-in-out">
                        <div class="text-indigo-600 mb-4">
                            <svg class="w-12 h-12" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>
                        </div>
                        <h3 class="text-xl font-bold text-gray-900 mb-3 dark:text-gray-100 transition-colors duration-300 ease-in-out">Proven Results</h3>
                        <p class="text-gray-600 dark:text-gray-300 transition-colors duration-300 ease-in-out">
                            A strong track record of students achieving excellent scores in their exams.
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Testimonials Section -->
        <section id="testimonials" class="page-section py-16 md:py-24 bg-gray-100 rounded-lg shadow-md mx-4 md:mx-auto max-w-6xl mt-8
                     dark:bg-gray-950 dark:shadow-xl transition-colors duration-300 ease-in-out">
            <div class="container mx-auto px-6 md:px-12 text-center">
                <h2 class="text-4xl font-extrabold text-gray-900 mb-12 dark:text-gray-100 transition-colors duration-300 ease-in-out">What Our Students Say</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                    <div class="bg-white p-8 rounded-xl shadow-lg flex flex-col items-center text-center
                                dark:bg-gray-800 dark:shadow-2xl transition-colors duration-300 ease-in-out">
                        <img src="Gemini_Generated_Image_q97477q97477q974.png" alt="Student testimonial image for Anjali Sharma" class="w-24 h-24 rounded-full mb-6 border-4 border-indigo-200 dark:border-indigo-700" loading="lazy">
                        <p class="text-lg text-gray-700 italic mb-4 dark:text-gray-300 transition-colors duration-300 ease-in-out">
                            "MATHEMATICO transformed my understanding of complex topics. The teachers are incredibly supportive and make learning fun!"
                        </p>
                        <p class="font-semibold text-indigo-700 dark:text-indigo-400 transition-colors duration-300 ease-in-out">- Anjali Sharma</p>
                        <p class="text-sm text-gray-500 dark:text-gray-400 transition-colors duration-300 ease-in-out">Class 10 Student</p>
                    </div>
                    <div class="bg-white p-8 rounded-xl shadow-lg flex flex-col items-center text-center
                                dark:bg-gray-800 dark:shadow-2xl transition-colors duration-300 ease-in-out">
                        <img src="Gemini_Generated_Image_a45rwpa45rwpa45r.png" alt="Student testimonial image for Rahul Verma" class="w-24 h-24 rounded-full mb-6 border-4 border-indigo-200 dark:border-indigo-700" loading="lazy">
                        <p class="text-lg text-gray-700 italic mb-4 dark:text-gray-300 transition-colors duration-300 ease-in-out">
                            "Thanks to their rigorous practice and clear explanations, I scored exceptionally well in my JEE Mains math section."
                        </p>
                        <p class="font-semibold text-indigo-700 dark:text-indigo-400 transition-colors duration-300 ease-in-out">- Rahul Verma</p>
                        <p class="text-sm text-gray-500 dark:text-gray-400 transition-colors duration-300 ease-in-out">JEE Aspirant</p>
                    </div>
                    <div class="bg-white p-8 rounded-xl shadow-lg flex flex-col items-center text-center
                                dark:bg-gray-800 dark:shadow-2xl transition-colors duration-300 ease-in-out">
                        <img src="Gemini_Generated_Image_r5xzj2r5xzj2r5xz.png" alt="Student testimonial image for Priya Singh" class="w-24 h-24 rounded-full mb-6 border-4 border-indigo-200 dark:border-indigo-700" loading="lazy">
                        <p class="text-lg text-gray-700 italic mb-4 dark:text-gray-300 transition-colors duration-300 ease-in-out">
                            "The personalized attention helped me grasp concepts I struggled with. Highly recommend for anyone looking to improve their math skills."
                        </p>
                        <p class="font-semibold text-indigo-700 dark:text-indigo-400 transition-colors duration-300 ease-in-out">- Priya Singh</p>
                        <p class="text-sm text-gray-500 dark:text-gray-400 transition-colors duration-300 ease-in-out">Class 12 Student</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Success Stories Section -->
        <section id="success-stories" class="page-section py-16 md:py-24 bg-white rounded-lg shadow-md mx-4 md:mx-auto max-w-6xl mt-8
                       dark:bg-gray-800 dark:shadow-xl transition-colors duration-300 ease-in-out">
            <div class="container mx-auto px-6 md:px-12 text-center">
                <h2 class="text-4xl font-extrabold text-gray-900 mb-12 dark:text-gray-100 transition-colors duration-300 ease-in-out">Our Success Stories</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                    <div class="bg-gray-50 p-8 rounded-xl shadow-lg flex flex-col items-center text-center
                                dark:bg-gray-700 dark:shadow-2xl transition-colors duration-300 ease-in-out">
                        <img src="Gemini_Generated_Image_ep7txep7txep7txe.png" alt="Successful student Rohan Kumar" class="w-24 h-24 rounded-full mb-6 border-4 border-purple-300 dark:border-purple-600" loading="lazy">
                        <h3 class="text-xl font-bold text-gray-900 mb-2 dark:text-gray-100">Rohan Kumar</h3>
                        <p class="text-gray-600 mb-4 dark:text-gray-300">IIT Bombay (JEE Advanced 2024)</p>
                        <p class="text-gray-700 italic dark:text-gray-300">"Achieved my dream thanks to the focused guidance and challenging problems provided by MATHEMATICO!"</p>
                    </div>
                    <div class="bg-gray-50 p-8 rounded-xl shadow-lg flex flex-col items-center text-center
                                dark:bg-gray-700 dark:shadow-2xl transition-colors duration-300 ease-in-out">
                        <img src="Gemini_Generated_Image_uwrcaruwrcaruwrc.png" alt="Successful student Sanya Gupta" class="w-24 h-24 rounded-full mb-6 border-4 border-purple-300 dark:border-purple-600" loading="lazy">
                        <h3 class="text-xl font-bold text-gray-900 mb-2 dark:text-gray-100">Sanya Gupta</h3>
                        <p class="text-gray-600 mb-4 dark:text-gray-300">ISI Kolkata (B.Stat Entrance 2024)</p>
                        <p class="text-gray-700 italic dark:text-gray-300">"The in-depth concept clarity and problem-solving strategies were key to my success in ISI entrance."</p>
                    </div>
                    <div class="bg-gray-50 p-8 rounded-xl shadow-lg flex flex-col items-center text-center
                                dark:bg-gray-700 dark:shadow-2xl transition-colors duration-300 ease-in-out">
                        <img src="Gemini_Generated_Image_o8ymwgo8ymwgo8ym.png" alt="Successful student Arjun Das" class="w-24 h-24 rounded-full mb-6 border-4 border-purple-300 dark:border-purple-600" loading="lazy">
                        <h3 class="text-xl font-bold text-gray-900 mb-2 dark:text-gray-100">Arjun Das</h3>
                        <p class="text-gray-600 mb-4 dark:text-gray-300">Class 12 Board Topper (98% Maths)</p>
                        <p class="text-gray-700 italic dark:text-gray-300">"From struggling to topping, MATHEMATICO made math my favorite subject. Highly grateful!"</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- FAQ Section -->
        <section id="faq" class="page-section py-16 md:py-24 bg-gray-100 rounded-lg shadow-md mx-4 md:mx-auto max-w-6xl mt-8
                       dark:bg-gray-950 dark:shadow-xl transition-colors duration-300 ease-in-out">
            <div class="container mx-auto px-6 md:px-12 text-center">
                <h2 class="text-4xl font-extrabold text-gray-900 mb-12 dark:text-gray-100 transition-colors duration-300 ease-in-out">Frequently Asked Questions</h2>
                <div class="max-w-3xl mx-auto text-left">
                    <div class="accordion-item bg-white dark:bg-gray-800 rounded-xl shadow-lg mb-4">
                        <div class="accordion-header text-gray-900 dark:text-gray-100" data-target="faq-1">
                            <h3 class="text-xl font-semibold">What are the batch timings and class frequency?</h3>
                            <svg class="w-6 h-6 transform transition-transform duration-300" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg>
                        </div>
                        <div id="faq-1" class="accordion-content text-gray-700 dark:text-gray-300">
                            <p>Our batches typically run twice a week for regular courses, with additional sessions for competitive exam preparation. Specific timings vary by batch and will be communicated upon enrollment. We offer both morning and evening slots.</p>
                        </div>
                    </div>
                    <div class="accordion-item bg-white dark:bg-gray-800 rounded-xl shadow-lg mb-4">
                        <div class="accordion-header text-gray-900 dark:text-gray-100" data-target="faq-2">
                            <h3 class="text-xl font-semibold">What is the fee structure for different courses?</h3>
                            <svg class="w-6 h-6 transform transition-transform duration-300" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg>
                        </div>
                        <div id="faq-2" class="accordion-content text-gray-700 dark:text-gray-300">
                            <p>Our fee structure is competitive and varies based on the course and duration. Please contact us directly via phone or email, or visit our centers in Madhyamgram or Barasat for detailed fee information and any ongoing discounts.</p>
                        </div>
                    </div>
                    <div class="accordion-item bg-white dark:bg-gray-800 rounded-xl shadow-lg mb-4">
                        <div class="accordion-header text-gray-900 dark:text-gray-100" data-target="faq-3">
                            <h3 class="text-xl font-semibold">Do you provide study materials and mock tests?</h3>
                            <svg class="w-6 h-6 transform transition-transform duration-300" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg>
                        </div>
                        <div id="faq-3" class="accordion-content text-gray-700 dark:text-gray-300">
                            <p>Yes, we provide comprehensive study materials, including notes, practice sheets, and recommended book lists. Regular mock tests are conducted to assess student progress and prepare them for exams. Performance analysis and feedback are also provided.</p>
                        </div>
                    </div>
                    <div class="accordion-item bg-white dark:bg-gray-800 rounded-xl shadow-lg mb-4">
                        <div class="accordion-header text-gray-900 dark:text-gray-100" data-target="faq-4">
                            <h3 class="text-xl font-semibold">What is the student-teacher ratio?</h3>
                            <svg class="w-6 h-6 transform transition-transform duration-300" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg>
                        </div>
                        <div id="faq-4" class="accordion-content text-gray-700 dark:text-gray-300">
                            <p>We maintain small batch sizes to ensure personalized attention for every student. Our student-teacher ratio is designed to foster an interactive learning environment where individual doubts can be addressed effectively.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Contact Section -->
        <section id="contact" class="page-section py-16 md:py-24 bg-white rounded-lg shadow-md mx-4 md:mx-auto max-w-6xl mt-8 mb-8
                       dark:bg-gray-800 dark:shadow-xl transition-colors duration-300 ease-in-out">
            <div class="container mx-auto px-6 md:px-12 text-center">
                <h2 class="text-4xl font-extrabold text-gray-900 mb-12 dark:text-gray-100 transition-colors duration-300 ease-in-out">Get in Touch with MATHEMATICO</h2>
                <div class="flex flex-col md:flex-row justify-center items-center gap-10">
                    <div class="md:w-1/2 bg-gray-50 p-8 rounded-xl shadow-lg text-left
                                dark:bg-gray-700 dark:shadow-2xl transition-colors duration-300 ease-in-out">
                        <h3 class="text-2xl font-bold text-gray-900 mb-6 dark:text-gray-100 transition-colors duration-300 ease-in-out">Contact Information</h3>
                        <p class="text-lg text-gray-700 mb-4 flex items-center dark:text-gray-300 transition-colors duration-300 ease-in-out">
                            <svg class="w-6 h-6 mr-3 text-indigo-600" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill-rule="evenodd" d="M10 2a8 8 0 100-16 8 8 0 000 16zm-1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l3 3a1 1 0 001.414-1.414L11 9.586V6a1 1 0 00-1-1z" clip-rule="evenodd"></path></svg>
                            <strong>Instructor:</strong> Dipanjan Chatterjee, M.Sc in Pure Maths
                        </p>
                        <p class="text-lg text-gray-700 mb-4 flex items-center dark:text-gray-300 transition-colors duration-300 ease-in-out">
                            <svg class="w-6 h-6 mr-3 text-indigo-600" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path d="M2 3a1 1 0 011-1h2.153a1 1 0 01.986.836l.74 4.435a1 1 0 01-.54 1.06l-1.548.774a11.037 11.037 0 006.105 6.105l.774-1.548a1 1 0 011.059-.54l4.435.74a1 1 0 01.836.986V17a1 1 0 01-1 1h-2C7.82 18 2 12.18 2 5V3z"></path></svg>
                            <strong>Phone:</strong> +91 9051089673
                        </p>
                        <p class="text-lg text-gray-700 mb-4 flex items-center dark:text-gray-300 transition-colors duration-300 ease-in-out">
                            <svg class="w-6 h-6 mr-3 text-indigo-600" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                                <path d="M2 3a1 1 0 011-1h2.153a1 1 0 01.986.836l.74 4.435a1 1 0 01-.54 1.06l-1.548.774a11.037 11.037 0 006.105 6.105l.774-1.548a1 1 0 011.059-.54l4.435.74a1 1 0 01.836.986V17a1 1 0 01-1 1h-2C7.82 18 2 12.18 2 5V3z"></path>
                            </svg>
                            <strong>Landline:</strong> +91-3331712372
                        </p>
                        <p class="text-lg text-gray-700 mb-4 flex items-center dark:text-gray-300 transition-colors duration-300 ease-in-out">
                            <svg class="w-6 h-6 mr-3 text-indigo-600" fill="currentColor" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-phone" aria-hidden="true"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6.86-6.86A19.79 19.79 0 0 1 2 4.18 2 2 0 0 1 4.18 2h3a2 2 0 0 1 2 1.72l.4 4.5a2 2 0 0 1-1.16 2.01l-1.68.84a10 10 0 0 0 6.16 6.16l.84-1.68a2 2 0 0 1 2.01-1.16l4.5.4a2 2 0 0 1 1.72 2z"></path></svg>
                            <strong>WhatsApp:</strong> <a href="https://wa.link/80qjr2" class="text-indigo-600 hover:underline dark:text-indigo-400" aria-label="Chat with us on WhatsApp">+91 9748559613</a>
                        </p>
                        <p class="text-lg text-gray-700 mb-4 flex items-center dark:text-gray-300 transition-colors duration-300 ease-in-out">
                            <svg class="w-6 h-6 mr-3 text-indigo-600" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path d="M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"></path><path d="M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"></path></svg>
                            <strong>Email:</strong> dipanjanchatterjee23@gmail.com
                        </p>
                        <p class="text-lg text-gray-700 mb-4 flex items-center dark:text-gray-300 transition-colors duration-300 ease-in-out">
                            <svg class="w-6 h-6 mr-3 text-indigo-600" fill="currentColor" viewBox="0 0 24 24" stroke="currentColor" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/>
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"/>
                            </svg>
                            <strong>Locations:</strong> Madhyamgram & Barasat
                        </p>
                        <p class="text-lg text-gray-700 mb-4 flex items-center dark:text-gray-300 transition-colors duration-300 ease-in-out">
                            <svg class="w-6 h-6 mr-3 text-indigo-600" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                                <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                            </svg>
                            <strong>Telegram:</strong> <a href="https://t.me/dipanjan9271" class="text-indigo-600 hover:underline dark:text-indigo-400" aria-label="Join our Telegram group">Join our Telegram Group</a>
                        </p>
                        <p class="text-lg text-gray-700 flex items-center dark:text-gray-300 transition-colors duration-300 ease-in-out">
                            <svg class="w-6 h-6 mr-3 text-indigo-600" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                                <path d="M12 14l9-5-9-5-9 5 9 5z"/>
                                <path d="M12 14l6.16-3.422a12.004 12.004 0 01-.476 1.772L12 16.5l-5.684-3.15a12.004 12.004 0 01-.476-1.772L12 14z"/>
                                <path d="M12 14l9-5-9-5-9 5 9 5z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M12 14l6.16-3.422a12.004 12.004 0 01-.476 1.772L12 16.5l-5.684-3.15a12.004 12.004 0 01-.476-1.772L12 14z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            <strong>Classes Available:</strong> Offline & Online
                        </p>
                        <h3 class="text-2xl font-bold text-gray-900 mt-8 mb-6 dark:text-gray-100 transition-colors duration-300 ease-in-out">Social Media</h3>
                        <div class="flex flex-wrap gap-4">
                            <a href="https://www.facebook.com/share/15gcnh3AeR/" target="_blank" rel="noopener noreferrer" class="text-gray-700 hover:text-indigo-700 dark:text-gray-300 dark:hover:text-indigo-400 transition-colors duration-300 ease-in-out flex items-center" aria-label="Facebook Page">
                                <svg class="w-8 h-8 mr-2" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path d="M22 12c0-5.523-4.477-10-10-10S2 6.477 2 12c0 4.991 3.657 9.128 8.438 9.878v-6.987h-2.54V12h2.54V9.797c0-2.506 1.492-3.89 3.777-3.89 1.094 0 2.238.195 2.238.195v2.46h-1.262c-1.225 0-1.624.767-1.624 1.569V12h2.773l-.443 2.89h-2.33V22C18.343 21.128 22 16.991 22 12z"></path></svg>
                                Facebook (Page)
                            </a>
                            <a href="https://www.facebook.com/share/g/1F6pJ4QCqJ/" target="_blank" rel="noopener noreferrer" class="text-gray-700 hover:text-indigo-700 dark:text-gray-300 dark:hover:text-indigo-400 transition-colors duration-300 ease-in-out flex items-center" aria-label="Facebook Group">
                                <svg class="w-8 h-8 mr-2" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path d="M22 12c0-5.523-4.477-10-10-10S2 6.477 2 12c0 4.991 3.657 9.128 8.438 9.878v-6.987h-2.54V12h2.54V9.797c0-2.506 1.492-3.89 3.777-3.89 1.094 0 2.238.195 2.238.195v2.46h-1.262c-1.225 0-1.624.767-1.624 1.569V12h2.773l-.443 2.89h-2.33V22C18.343 21.128 22 16.991 22 12z"></path></svg>
                                Facebook (Group)
                            </a>
                        </div>
                    </div>
                    <div class="md:w-1/2 bg-gray-50 p-8 rounded-xl shadow-lg
                                dark:bg-gray-700 dark:shadow-2xl transition-colors duration-300 ease-in-out">
                        <h3 class="text-2xl font-bold text-gray-900 mb-6 dark:text-gray-100 transition-colors duration-300 ease-in-out">Send Us a Message</h3>
                        <!-- Google Form for Contact Us -->
                        <form action="YOUR_CONTACT_GOOGLE_FORM_ACTION_URL" method="POST" target="_blank">
                            <div class="mb-4">
                                <label for="contact-name" class="sr-only">Your Name</label>
                                <input type="text" id="contact-name" name="entry.YOUR_NAME_FIELD_ID" placeholder="Your Name" class="w-full px-4 py-3 rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500
                                                                 dark:bg-gray-800 dark:text-gray-100 dark:border-gray-600 transition-colors duration-300 ease-in-out" required aria-required="true">
                            </div>
                            <div class="mb-4">
                                <label for="contact-email" class="sr-only">Your Email</label>
                                <input type="email" id="contact-email" name="entry.YOUR_EMAIL_FIELD_ID" placeholder="Your Email" class="w-full px-4 py-3 rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500
                                                                  dark:bg-gray-800 dark:text-gray-100 dark:border-gray-600 transition-colors duration-300 ease-in-out" required aria-required="true">
                            </div>
                            <div class="mb-6">
                                <label for="contact-message" class="sr-only">Your Message</label>
                                <textarea id="contact-message" name="entry.YOUR_MESSAGE_FIELD_ID" rows="5" placeholder="Your Message" class="w-full px-4 py-3 rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500
                                                                   dark:bg-gray-800 dark:text-gray-100 dark:border-gray-600 transition-colors duration-300 ease-in-out" required aria-required="true"></textarea>
                            </div>
                            <button type="submit" class="w-full bg-indigo-600 text-white px-6 py-3 rounded-full text-lg font-semibold hover:bg-indigo-700 transition duration-300 ease-in-out shadow-md transform hover:scale-105" aria-label="Send your message">
                                Send Message
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </section>

        <!-- Google Maps Section -->
        <section id="google-maps" class="page-section py-16 md:py-24 bg-gray-100 rounded-lg shadow-md mx-4 md:mx-auto max-w-6xl mt-8 mb-8
                       dark:bg-gray-950 dark:shadow-xl transition-colors duration-300 ease-in-out">
            <div class="container mx-auto px-6 md:px-12 text-center">
                <h2 class="text-4xl font-extrabold text-gray-900 mb-12 dark:text-gray-100 transition-colors duration-300 ease-in-out">Find Us on the Map</h2>
                <div class="aspect-w-16 aspect-h-9 w-full h-96 bg-gray-200 rounded-xl overflow-hidden shadow-lg dark:bg-gray-700">
                    <iframe
                        src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d4432.400349212377!2d88.4818971!3d22.724887199999998!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x39f8a30058617907%3A0x6fb9d10ae1c6b946!2sMATHEMATICO%20(Maths%20Coaching)%20By%20DipanjanSir!5e0!3m2!1sen!2sin!4v1751963886629!5m2!1sen!2sin"
                        width="100%"
                        height="400"
                        style="border:0;"
                        allowfullscreen=""
                        loading="lazy"
                        referrerpolicy="no-referrer-when-downgrade"
                        title="Google Maps location of MATHEMATICO">
                    </iframe>
                    <p class="text-gray-600 dark:text-gray-300 mt-4"> (Please replace the `src` attribute with your actual Google Maps embed code for Madhyamgram and Barasat locations.) </p>
                </div>
            </div>
        </section>

        <!-- Useful Links Section -->
        <section id="links" class="page-section py-16 md:py-24 bg-white rounded-lg shadow-md mx-4 md:mx-auto max-w-6xl mt-8 mb-8
                       dark:bg-gray-800 dark:shadow-xl transition-colors duration-300 ease-in-out">
            <div class="container mx-auto px-6 md:px-12 text-center">
                <h2 class="text-4xl font-extrabold text-gray-900 mb-12 dark:text-gray-100 transition-colors duration-300 ease-in-out">Useful Links</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                    <div class="bg-indigo-50 p-8 rounded-xl shadow-lg hover:shadow-xl transform hover:scale-105 transition duration-300 ease-in-out
                                 dark:bg-gray-700 dark:shadow-2xl transition-colors duration-300 ease-in-out">
                        <h3 class="text-2xl font-bold text-gray-900 mb-4 dark:text-gray-100 transition-colors duration-300 ease-in-out">Official Page Link</h3>
                        <p class="text-gray-600 mb-6 dark:text-gray-300 transition-colors duration-300 ease-in-out">
                            Visit our main official page for more information.
                        </p>
                        <a href="https://www.facebook.com/share/15gcnh3AeR/" target="_blank" rel="noopener noreferrer" class="bg-indigo-600 text-white px-6 py-3 rounded-full text-md font-semibold hover:bg-indigo-700 transition duration-300 ease-in-out" aria-label="Go to official page">Go to Page</a>
                    </div>
                    <div class="bg-indigo-50 p-8 rounded-xl shadow-lg hover:shadow-xl transform hover:scale-105 transition duration-300 ease-in-out
                                 dark:bg-gray-700 dark:shadow-2xl transition-colors duration-300 ease-in-out">
                        <h3 class="text-2xl font-bold text-gray-900 mb-4 dark:text-gray-100 transition-colors duration-300 ease-in-out">Community Group Link</h3>
                        <p class="text-gray-600 mb-6 dark:text-gray-300 transition-colors duration-300 ease-in-out">
                            Join our community group for discussions and updates.
                        </p>
                        <a href="https://www.facebook.com/share/g/1F6pJ4QCqJ/" target="_blank" rel="noopener noreferrer" class="bg-indigo-600 text-white px-6 py-3 rounded-full text-md font-semibold hover:bg-indigo-700 transition duration-300 ease-in-out" aria-label="Join community group">Join Group</a>
                    </div>
                    <!-- New Section: Email Newsletter Sign-up -->
                    <div class="bg-indigo-50 p-8 rounded-xl shadow-lg hover:shadow-xl transform hover:scale-105 transition duration-300 ease-in-out
                                 dark:bg-gray-700 dark:shadow-2xl transition-colors duration-300 ease-in-out">
                        <h3 class="text-2xl font-bold text-gray-900 mb-4 dark:text-gray-100 transition-colors duration-300 ease-in-out">Newsletter Sign-up</h3>
                        <!-- Google Form for Newsletter -->
                        <form action="YOUR_NEWSLETTER_GOOGLE_FORM_ACTION_URL" method="POST" target="_blank" class="flex flex-col gap-4">
                            <label for="newsletter-email" class="sr-only">Email address</label>
                            <input type="email" id="newsletter-email" name="entry.YOUR_NEWSLETTER_EMAIL_FIELD_ID" placeholder="Your email address" class="w-full px-4 py-3 rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500
                                                                   dark:bg-gray-800 dark:text-gray-100 dark:border-gray-600 transition-colors duration-300 ease-in-out" required aria-required="true">
                            <button type="submit" class="bg-indigo-600 text-white px-6 py-3 rounded-full text-md font-semibold hover:bg-indigo-700 transition duration-300 ease-in-out" aria-label="Subscribe to newsletter">Subscribe</button>
                        </form>
                    </div>
                </div>
            </div>
        </section>

        <!-- Book List Page -->
        <section id="book-list-page" class="page-section hidden py-16 md:py-24 bg-gray-100 rounded-lg shadow-md mx-4 md:mx-auto max-w-6xl mt-8
                       dark:bg-gray-950 dark:shadow-xl transition-colors duration-300 ease-in-out">
            <div class="container mx-auto px-6 md:px-12 text-center">
                <h2 class="text-4xl font-extrabold text-gray-900 mb-12 dark:text-gray-100">Book List</h2>

                <!-- Admin Add/Edit Book Form (visible only to admin) -->
                <div id="book-list-admin-panel" class="admin-panel hidden bg-white p-8 rounded-xl shadow-lg mb-8 dark:bg-gray-800">
                    <h3 class="text-2xl font-bold text-gray-900 mb-4 dark:text-gray-100">Add/Edit Book</h3>
                    <form id="add-edit-book-form" class="text-left">
                        <input type="hidden" id="book-id">
                        <div class="mb-4">
                            <label for="book-title" class="block text-gray-700 dark:text-gray-300 text-sm font-bold mb-2">Title:</label>
                            <input type="text" id="book-title" class="w-full px-4 py-3 rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 dark:bg-gray-700 dark:text-gray-100 dark:border-gray-600" required>
                        </div>
                        <div class="mb-4">
                            <label for="book-author" class="block text-gray-700 dark:text-gray-300 text-sm font-bold mb-2">Author:</label>
                            <input type="text" id="book-author" class="w-full px-4 py-3 rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 dark:bg-gray-700 dark:text-gray-100 dark:border-gray-600" required>
                        </div>
                        <div class="mb-4">
                            <label for="book-category" class="block text-gray-700 dark:text-gray-300 text-sm font-bold mb-2">Category:</label>
                            <input type="text" id="book-category" class="w-full px-4 py-3 rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 dark:bg-gray-700 dark:text-gray-100 dark:border-gray-600" required>
                        </div>
                        <div class="mb-4">
                            <label for="book-description" class="block text-gray-700 dark:text-gray-300 text-sm font-bold mb-2">Description:</label>
                            <textarea id="book-description" rows="3" class="w-full px-4 py-3 rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 dark:bg-gray-700 dark:text-gray-100 dark:border-gray-600" required></textarea>
                        </div>
                        <div class="mb-4">
                            <label for="book-url" class="block text-gray-700 dark:text-gray-300 text-sm font-bold mb-2">URL (Optional):</label>
                            <input type="url" id="book-url" class="w-full px-4 py-3 rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 dark:bg-gray-700 dark:text-gray-100 dark:border-gray-600">
                        </div>
                        <button type="submit" class="bg-indigo-600 text-white px-6 py-3 rounded-full text-md font-semibold hover:bg-indigo-700 transition duration-300 ease-in-out">Save Book</button>
                        <button type="button" id="cancel-edit-book-btn" class="bg-gray-400 text-white px-6 py-3 rounded-full text-md font-semibold hover:bg-gray-500 transition duration-300 ease-in-out ml-2 hidden">Cancel Edit</button>
                    </form>
                </div>

                <!-- Book List Display -->
                <div id="book-list-display" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                    <p id="book-list-loading" class="text-gray-600 dark:text-gray-300 text-center col-span-full">Loading books... <span class="spinner"></span></p>
                    <!-- Books will be dynamically loaded here -->
                </div>
            </div>
        </section>

        <!-- Problems Page -->
        <section id="problems-page" class="page-section hidden py-16 md:py-24 bg-gray-100 rounded-lg shadow-md mx-4 md:mx-auto max-w-6xl mt-8
                       dark:bg-gray-950 dark:shadow-xl transition-colors duration-300 ease-in-out">
            <div class="container mx-auto px-6 md:px-12 text-center">
                <h2 class="text-4xl font-extrabold text-gray-900 mb-12 dark:text-gray-100">Practice Problems</h2>

                <!-- Admin Add Problem Form (visible only to admin) -->
                <div id="problems-admin-panel" class="admin-panel hidden bg-white p-8 rounded-xl shadow-lg mb-8 dark:bg-gray-800">
                    <h3 class="text-2xl font-bold text-gray-900 mb-4 dark:text-gray-100">Add New Problem</h3>
                    <form id="add-problem-form" class="text-left">
                        <input type="hidden" id="problem-id">
                        <div class="mb-4">
                            <label for="problem-title" class="block text-gray-700 dark:text-gray-300 text-sm font-bold mb-2">Title:</label>
                            <input type="text" id="problem-title" class="w-full px-4 py-3 rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 dark:bg-gray-700 dark:text-gray-100 dark:border-gray-600" required>
                        </div>
                        <div class="mb-4">
                            <label for="problem-category" class="block text-gray-700 dark:text-gray-300 text-sm font-bold mb-2">Category:</label>
                            <select id="problem-category" class="w-full px-4 py-3 rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 dark:bg-gray-700 dark:text-gray-100 dark:border-gray-600" required>
                                <option value="">Select Category</option>
                                <option value="Geometry">Geometry</option>
                                <option value="Inequality">Inequality</option>
                                <option value="Number Theory">Number Theory</option>
                                <option value="Calculus">Calculus</option>
                                <option value="Algebra">Algebra</option>
                            </select>
                        </div>
                        <div class="mb-4">
                            <label for="problem-description" class="block text-gray-700 dark:text-gray-300 text-sm font-bold mb-2">Description:</label>
                            <textarea id="problem-description" rows="5" class="w-full px-4 py-3 rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 dark:bg-gray-700 dark:text-gray-100 dark:border-gray-600" required></textarea>
                        </div>
                        <div class="mb-4">
                            <label for="problem-solution-url" class="block text-gray-700 dark:text-gray-300 text-sm font-bold mb-2">Solution URL (Optional):</label>
                            <input type="url" id="problem-solution-url" class="w-full px-4 py-3 rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 dark:bg-gray-700 dark:text-gray-100 dark:border-gray-600">
                        </div>
                        <button type="submit" class="bg-indigo-600 text-white px-6 py-3 rounded-full text-md font-semibold hover:bg-indigo-700 transition duration-300 ease-in-out">Add Problem</button>
                        <button type="button" id="cancel-edit-problem-btn" class="bg-gray-400 text-white px-6 py-3 rounded-full text-md font-semibold hover:bg-gray-500 transition duration-300 ease-in-out ml-2 hidden">Cancel Edit</button>
                    </form>
                </div>

                <!-- Problem Categories and Display -->
                <div id="problems-display" class="text-left">
                    <p id="problems-loading" class="text-gray-600 dark:text-gray-300 text-center col-span-full">Loading problems... <span class="spinner"></span></p>
                    <!-- Problems will be dynamically loaded here, categorized -->
                </div>
            </div>
        </section>

        <!-- Gallery Page -->
        <section id="gallery-page" class="page-section hidden py-16 md:py-24 bg-gray-100 rounded-lg shadow-md mx-4 md:mx-auto max-w-6xl mt-8
                       dark:bg-gray-950 dark:shadow-xl transition-colors duration-300 ease-in-out">
            <div class="container mx-auto px-6 md:px-12 text-center">
                <h2 class="text-4xl font-extrabold text-gray-900 mb-12 dark:text-gray-100">Our Gallery</h2>

                <!-- Admin Add Gallery Post Form (visible only to admin) -->
                <div id="gallery-admin-panel" class="admin-panel hidden bg-white p-8 rounded-xl shadow-lg mb-8 dark:bg-gray-800">
                    <h3 class="text-2xl font-bold text-gray-900 mb-4 dark:text-gray-100">Add New Gallery Post</h3>
                    <form id="add-gallery-form" class="text-left">
                        <input type="hidden" id="gallery-post-id">
                        <div class="mb-4">
                            <label for="gallery-image-url" class="block text-gray-700 dark:text-gray-300 text-sm font-bold mb-2">Image URL:</label>
                            <input type="url" id="gallery-image-url" class="w-full px-4 py-3 rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 dark:bg-gray-700 dark:text-gray-100 dark:border-gray-600" required>
                        </div>
                        <div class="mb-4">
                            <label for="gallery-caption" class="block text-gray-700 dark:text-gray-300 text-sm font-bold mb-2">Caption:</label>
                            <textarea id="gallery-caption" rows="3" class="w-full px-4 py-3 rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 dark:bg-gray-700 dark:text-gray-100 dark:border-gray-600" required></textarea>
                        </div>
                        <button type="submit" class="bg-indigo-600 text-white px-6 py-3 rounded-full text-md font-semibold hover:bg-indigo-700 transition duration-300 ease-in-out">Add Post</button>
                        <button type="button" id="cancel-edit-gallery-btn" class="bg-gray-400 text-white px-6 py-3 rounded-full text-md font-semibold hover:bg-gray-500 transition duration-300 ease-in-out ml-2 hidden">Cancel Edit</button>
                    </form>
                </div>

                <!-- Gallery Display -->
                <div id="gallery-display" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
                    <p id="gallery-loading" class="text-gray-600 dark:text-gray-300 text-center col-span-full">Loading gallery... <span class="spinner"></span></p>
                    <!-- Gallery posts will be dynamically loaded here -->
                </div>
            </div>
        </section>

        <!-- Blog Page -->
        <section id="blog-page" class="page-section hidden py-16 md:py-24 bg-gray-100 rounded-lg shadow-md mx-4 md:mx-auto max-w-6xl mt-8
                       dark:bg-gray-950 dark:shadow-xl transition-colors duration-300 ease-in-out">
            <div class="container mx-auto px-6 md:px-12 text-center">
                <h2 class="text-4xl font-extrabold text-gray-900 mb-12 dark:text-gray-100">Our Blog & Articles</h2>

                <!-- Admin Add Blog Post Form (visible only to admin) -->
                <div id="blog-admin-panel" class="admin-panel hidden bg-white p-8 rounded-xl shadow-lg mb-8 dark:bg-gray-800">
                    <h3 class="text-2xl font-bold text-gray-900 mb-4 dark:text-gray-100">Add New Blog Post</h3>
                    <form id="add-blog-form" class="text-left">
                        <input type="hidden" id="blog-post-id">
                        <div class="mb-4">
                            <label for="blog-title" class="block text-gray-700 dark:text-gray-300 text-sm font-bold mb-2">Title:</label>
                            <input type="text" id="blog-title" class="w-full px-4 py-3 rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 dark:bg-gray-700 dark:text-gray-100 dark:border-gray-600" required>
                        </div>
                        <div class="mb-4">
                            <label for="blog-image-url" class="block text-gray-700 dark:text-gray-300 text-sm font-bold mb-2">Image URL (Optional):</label>
                            <input type="url" id="blog-image-url" class="w-full px-4 py-3 rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 dark:bg-gray-700 dark:text-gray-100 dark:border-gray-600">
                        </div>
                        <div class="mb-4">
                            <label for="blog-content" class="block text-gray-700 dark:text-gray-300 text-sm font-bold mb-2">Content:</label>
                            <textarea id="blog-content" rows="10" class="w-full px-4 py-3 rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 dark:bg-gray-700 dark:text-gray-100 dark:border-gray-600" required></textarea>
                        </div>
                        <button type="submit" class="bg-indigo-600 text-white px-6 py-3 rounded-full text-md font-semibold hover:bg-indigo-700 transition duration-300 ease-in-out">Save Blog Post</button>
                        <button type="button" id="cancel-edit-blog-btn" class="bg-gray-400 text-white px-6 py-3 rounded-full text-md font-semibold hover:bg-gray-500 transition duration-300 ease-in-out ml-2 hidden">Cancel Edit</button>
                    </form>
                </div>

                <!-- Blog Posts Display -->
                <div id="blog-display" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                    <p id="blog-loading" class="text-gray-600 dark:text-gray-300 text-center col-span-full">Loading blog posts... <span class="spinner"></span></p>
                    <!-- Blog posts will be dynamically loaded here -->
                </div>
            </div>
        </section>

        <!-- Admin Page -->
        <section id="admin-page" class="page-section hidden py-16 md:py-24 bg-gray-100 rounded-lg shadow-md mx-4 md:mx-auto max-w-6xl mt-8 mb-8
                       dark:bg-gray-950 dark:shadow-xl transition-colors duration-300 ease-in-out">
            <div class="container mx-auto px-6 md:px-12 text-center">
                <h2 class="text-4xl font-extrabold text-gray-900 mb-12 dark:text-gray-100">Admin Panel</h2>

                <!-- Admin Authentication Section -->
                <div id="auth-section" class="bg-white p-8 rounded-xl shadow-lg mb-8 dark:bg-gray-800 max-w-md mx-auto">
                    <h3 class="text-2xl font-bold text-gray-900 mb-6 dark:text-gray-100" id="auth-heading">Admin Login</h3>

                    <div id="login-form-container">
                        <div class="mb-4">
                            <label for="admin-email" class="sr-only">Email</label>
                            <input type="email" id="admin-email" placeholder="Email" class="w-full px-4 py-3 rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 dark:bg-gray-700 dark:text-gray-100 dark:border-gray-600" required>
                        </div>
                        <div class="mb-6">
                            <label for="admin-password" class="sr-only">Password</label>
                            <input type="password" id="admin-password" placeholder="Password" class="w-full px-4 py-3 rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 dark:bg-gray-700 dark:text-gray-100 dark:border-gray-600" required>
                        </div>
                        <button id="login-btn" class="w-full bg-indigo-600 text-white px-6 py-3 rounded-full text-md font-semibold hover:bg-indigo-700 transition duration-300 ease-in-out mb-4">Login</button>
                        <button id="google-login-btn" class="w-full bg-red-600 text-white px-6 py-3 rounded-full text-md font-semibold hover:bg-red-700 transition duration-300 ease-in-out flex items-center justify-center gap-2 mb-4">
                            <svg class="w-5 h-5" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12.24 10.285V11.85h2.956c-.134 1.54-.888 2.766-2.956 2.766-1.72 0-3.12-1.398-3.12-3.12s1.4-3.12 3.12-3.12c.884 0 1.637.368 2.22 1.01L15.99 7.74c-1.01-1.01-2.31-1.637-3.75-1.637-3.12 0-5.64 2.52-5.64 5.64s2.52 5.64 5.64 5.64c3.12 0 5.42-2.26 5.42-5.54 0-.39-.03-.76-.08-1.12h-5.34z" fill="#fff"/></svg>
                            Sign in with Google
                        </button>
                        <button id="register-toggle-btn" class="w-full bg-gray-400 text-white px-6 py-3 rounded-full text-md font-semibold hover:bg-gray-500 transition duration-300 ease-in-out mb-4">Register</button>
                        <button id="forgot-password-btn" class="w-full text-indigo-600 hover:underline text-md font-semibold dark:text-indigo-400">Forgot Password?</button>
                        <p id="auth-message" class="text-red-500 mt-4 hidden"></p>
                    </div>

                    <div id="register-form-container" class="hidden">
                        <div class="mb-4">
                            <label for="register-email" class="sr-only">Email</label>
                            <input type="email" id="register-email" placeholder="Email" class="w-full px-4 py-3 rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 dark:bg-gray-700 dark:text-gray-100 dark:border-gray-600" required>
                        </div>
                        <div class="mb-6">
                            <label for="register-password" class="sr-only">Password</label>
                            <input type="password" id="register-password" placeholder="Password" class="w-full px-4 py-3 rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 dark:bg-gray-700 dark:text-gray-100 dark:border-gray-600" required>
                        </div>
                        <button id="register-btn" class="w-full bg-indigo-600 text-white px-6 py-3 rounded-full text-md font-semibold hover:bg-indigo-700 transition duration-300 ease-in-out mb-4">Register</button>
                        <button id="login-toggle-btn" class="w-full bg-gray-400 text-white px-6 py-3 rounded-full text-md font-semibold hover:bg-gray-500 transition duration-300 ease-in-out">Back to Login</button>
                        <p id="register-message" class="text-red-500 mt-4 hidden"></p>
                    </div>

                    <div id="admin-dashboard" class="hidden">
                        <p class="text-gray-700 dark:text-gray-300 mb-4">Welcome, <span id="user-email-display" class="font-bold"></span>!</p>
                        <p class="text-gray-700 dark:text-gray-300 mb-6">Your User ID: <span id="user-id-display" class="font-mono text-sm break-all"></span></p>
                        <button id="logout-btn" class="w-full bg-red-600 text-white px-6 py-3 rounded-full text-md font-semibold hover:bg-red-700 transition duration-300 ease-in-out">Logout</button>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <!-- Floating WhatsApp CTA Button -->
    <a href="https://wa.me/919748559613" class="fixed bottom-6 right-6 z-50 bg-green-500 p-3 rounded-full shadow-lg hover:scale-110 transition-transform duration-300 whatsapp-cta" aria-label="Chat on WhatsApp">
        <img src="https://img.icons8.com/color/48/000000/whatsapp--v1.png" alt="WhatsApp icon" class="w-10 h-10">
    </a>

    <!-- Scroll-to-top Button -->
    <button id="scroll-to-top" aria-label="Scroll to top">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 10l7-7m0 0l7 7m-7-7v18"></path>
        </svg>
    </button>

    <!-- Enrollment Modal Structure -->
    <div id="enrollment-modal" class="modal" role="dialog" aria-modal="true" aria-labelledby="enrollment-modal-title">
        <div class="modal-content">
            <button class="modal-close-button" aria-label="Close enrollment form">&times;</button>
            <h3 id="enrollment-modal-title" class="text-2xl font-bold text-gray-900 mb-6 dark:text-gray-100">Enroll in <span id="modal-course-name"></span></h3>
            <!-- Google Form embedded via iframe -->
            <iframe id="enrollment-google-form-iframe" src="" frameborder="0" marginheight="0" marginwidth="0" title="Enrollment Form">Loading...</iframe>
        </div>
    </div>

    <!-- Message Box Modal -->
    <div id="message-box-modal" class="modal" role="dialog" aria-modal="true" aria-labelledby="message-box-title">
        <div class="modal-content max-w-sm h-auto">
            <button class="modal-close-button" aria-label="Close message box">&times;</button>
            <h3 id="message-box-title" class="text-xl font-bold text-gray-900 mb-4 dark:text-gray-100"></h3>
            <p id="message-box-content" class="text-gray-700 dark:text-gray-300 mb-4"></p>
            <button id="message-box-ok-btn" class="bg-indigo-600 text-white px-6 py-3 rounded-full text-md font-semibold hover:bg-indigo-700 transition duration-300 ease-in-out">OK</button>
        </div>
    </div>


    <!-- Firebase SDKs -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword, signOut, onAuthStateChanged, GoogleAuthProvider, signInWithPopup, sendPasswordResetEmail, signInAnonymously, signInWithCustomToken } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, collection, addDoc, getDocs, doc, updateDoc, deleteDoc, onSnapshot, query, orderBy, setDoc, getDoc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // Firebase configuration and initialization
        // IMPORTANT: Replace with your actual Firebase project configuration
        const firebaseConfig = {
            apiKey: "AIzaSyCIKdwTmJxok8VodE3lUI-1UlH1WNadfpc",
            authDomain: "mathematico-website.firebaseapp.com",
            projectId: "mathematico-website",
            storageBucket: "mathematico-website.firebasestorage.app",
            messagingSenderId: "186709981685",
            appId: "1:186709981685:web:b86177e07352cb5f1c48bc",
            measurementId: "G-5Z24Z4Q97Q"
        };

        const appId = typeof __app_id !== 'undefined' ? __app_id : firebaseConfig.projectId; // Use Canvas provided app ID or default

        let app;
        let db;
        let auth;
        let userId = 'anonymous'; // Default to anonymous
        let isAdmin = false; // Global flag for admin status

        // Initialize Firebase
        if (firebaseConfig.apiKey && firebaseConfig.projectId && firebaseConfig.authDomain) {
            app = initializeApp(firebaseConfig);
            db = getFirestore(app);
            auth = getAuth(app);

            // Authenticate user with custom token if provided by Canvas, otherwise anonymously
            if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) {
                signInWithCustomToken(auth, __initial_auth_token).then((userCredential) => {
                    userId = userCredential.user.uid;
                    console.log("Firebase signed in with custom token:", userId);
                    checkAdminStatus(userCredential.user);
                }).catch((error) => {
                    console.error("Error signing in with custom token:", error);
                    signInAnonymously(auth).then((userCredential) => {
                        userId = userCredential.user.uid;
                        console.log("Firebase signed in anonymously:", userId);
                        checkAdminStatus(userCredential.user);
                    }).catch((anonError) => {
                        console.error("Error signing in anonymously:", anonError);
                        showMessageBox("Authentication Error", "Failed to authenticate. Some features may not be available.");
                    });
                });
            } else {
                signInAnonymously(auth).then((userCredential) => {
                    userId = userCredential.user.uid;
                    console.log("Firebase signed in anonymously:", userId);
                    checkAdminStatus(userCredential.user);
                }).catch((error) => {
                    console.error("Error signing in anonymously:", error);
                    showMessageBox("Authentication Error", "Failed to authenticate anonymously. Some features may not be available.");
                });
            }
        } else {
            console.warn("Firebase config not fully provided. Firestore and Auth features will not work.");
            showMessageBox("Configuration Error", "Firebase is not configured. Admin and data management features will be disabled.");
            // Hide all admin panels if Firebase is not initialized
            document.querySelectorAll('.admin-panel').forEach(el => el.classList.add('hidden'));
            document.getElementById('auth-section').classList.add('hidden');
        }

        // Function to check admin status (using a Firestore 'roles' collection for flexibility)
        async function checkAdminStatus(user) {
            if (!db || !user) {
                isAdmin = false;
                updateAdminUI();
                return;
            }
            try {
                const userDocRef = doc(db, `artifacts/${appId}/public/users/${user.uid}`);
                const userDocSnap = await getDoc(userDocRef);
                if (userDocSnap.exists() && userDocSnap.data().role === 'admin') {
                    isAdmin = true;
                    console.log("User is an admin.");
                } else {
                    isAdmin = false;
                    console.log("User is not an admin or role not set.");
                }
            } catch (e) {
                console.error("Error checking admin status:", e);
                isAdmin = false;
            }
            updateAdminUI();
            initializeFirestoreListeners(); // Initialize listeners after auth state and admin status are known
        }

        // Function to update UI based on admin status
        function updateAdminUI() {
            const adminPanels = document.querySelectorAll('.admin-panel');
            const adminIndicator = document.getElementById('admin-mode-indicator');
            const authSection = document.getElementById('auth-section');
            const loginFormContainer = document.getElementById('login-form-container');
            const registerFormContainer = document.getElementById('register-form-container');
            const adminDashboard = document.getElementById('admin-dashboard');
            const userEmailDisplay = document.getElementById('user-email-display');
            const userIdDisplay = document.getElementById('user-id-display');
            const authHeading = document.getElementById('auth-heading');

            if (isAdmin) {
                adminPanels.forEach(panel => panel.classList.remove('hidden'));
                adminIndicator.classList.add('active');
                if (auth.currentUser) {
                    authHeading.textContent = "Admin Dashboard";
                    loginFormContainer.classList.add('hidden');
                    registerFormContainer.classList.add('hidden');
                    adminDashboard.classList.remove('hidden');
                    userEmailDisplay.textContent = auth.currentUser.email || 'N/A';
                    userIdDisplay.textContent = auth.currentUser.uid;
                }
            } else {
                adminPanels.forEach(panel => panel.classList.add('hidden'));
                adminIndicator.classList.remove('active');
                if (auth.currentUser && !auth.currentUser.isAnonymous) { // Logged in but not admin
                    authHeading.textContent = "User Profile";
                    loginFormContainer.classList.add('hidden');
                    registerFormContainer.classList.add('hidden');
                    adminDashboard.classList.remove('hidden');
                    userEmailDisplay.textContent = auth.currentUser.email || 'N/A';
                    userIdDisplay.textContent = auth.currentUser.uid;
                } else { // Not logged in or anonymous
                    authHeading.textContent = "Admin Login";
                    loginFormContainer.classList.remove('hidden');
                    registerFormContainer.classList.add('hidden');
                    adminDashboard.classList.add('hidden');
                }
            }
        }


        // --- DOM Elements ---
        const themeToggle = document.getElementById('theme-toggle');
        const htmlElement = document.documentElement;
        const sunIcon = document.getElementById('sun-icon');
        const moonIcon = document.getElementById('moon-icon');
        const hamburgerButton = document.getElementById('hamburger-button');
        const navbarLinks = document.getElementById('navbar-links');
        const scrollToTopButton = document.getElementById('scroll-to-top');
        const enrollmentModal = document.getElementById('enrollment-modal');
        const modalCloseButton = document.querySelector('#enrollment-modal .modal-close-button');
        const enrollButtons = document.querySelectorAll('.enroll-button');
        const modalCourseName = document.getElementById('modal-course-name');
        const enrollmentGoogleFormIframe = document.getElementById('enrollment-google-form-iframe');

        const mainContentContainer = document.getElementById('main-content-container');
        const pageSections = document.querySelectorAll('.page-section');

        // Admin Auth Elements
        const adminEmailInput = document.getElementById('admin-email');
        const adminPasswordInput = document.getElementById('admin-password');
        const loginBtn = document.getElementById('login-btn');
        const googleLoginBtn = document.getElementById('google-login-btn');
        const registerToggleBtn = document.getElementById('register-toggle-btn');
        const forgotPasswordBtn = document.getElementById('forgot-password-btn');
        const authMessage = document.getElementById('auth-message');

        const registerEmailInput = document.getElementById('register-email');
        const registerPasswordInput = document.getElementById('register-password');
        const registerBtn = document.getElementById('register-btn');
        const loginToggleBtn = document.getElementById('login-toggle-btn');
        const registerMessage = document.getElementById('register-message');

        const logoutBtn = document.getElementById('logout-btn');

        // Book List Elements
        const bookListAdminPanel = document.getElementById('book-list-admin-panel');
        const addEditBookForm = document.getElementById('add-edit-book-form');
        const bookIdInput = document.getElementById('book-id');
        const bookTitleInput = document.getElementById('book-title');
        const bookAuthorInput = document.getElementById('book-author');
        const bookCategoryInput = document.getElementById('book-category');
        const bookDescriptionInput = document.getElementById('book-description');
        const bookUrlInput = document.getElementById('book-url');
        const cancelEditBookBtn = document.getElementById('cancel-edit-book-btn');
        const bookListDisplay = document.getElementById('book-list-display');
        const bookListLoading = document.getElementById('book-list-loading');

        // Problems Elements
        const problemsAdminPanel = document.getElementById('problems-admin-panel');
        const addProblemForm = document.getElementById('add-problem-form');
        const problemIdInput = document.getElementById('problem-id');
        const problemTitleInput = document.getElementById('problem-title');
        const problemCategorySelect = document.getElementById('problem-category');
        const problemDescriptionInput = document.getElementById('problem-description');
        const problemSolutionUrlInput = document.getElementById('problem-solution-url');
        const cancelEditProblemBtn = document.getElementById('cancel-edit-problem-btn');
        const problemsDisplay = document.getElementById('problems-display');
        const problemsLoading = document.getElementById('problems-loading');

        // Gallery Elements
        const galleryAdminPanel = document.getElementById('gallery-admin-panel');
        const addGalleryForm = document.getElementById('add-gallery-form');
        const galleryPostIdInput = document.getElementById('gallery-post-id');
        const galleryImageUrlInput = document.getElementById('gallery-image-url');
        const galleryCaptionInput = document.getElementById('gallery-caption');
        const cancelEditGalleryBtn = document.getElementById('cancel-edit-gallery-btn');
        const galleryDisplay = document.getElementById('gallery-display');
        const galleryLoading = document.getElementById('gallery-loading');

        // Blog Elements
        const blogAdminPanel = document.getElementById('blog-admin-panel');
        const addBlogForm = document.getElementById('add-blog-form');
        const blogPostIdInput = document.getElementById('blog-post-id');
        const blogTitleInput = document.getElementById('blog-title');
        const blogImageUrlInput = document.getElementById('blog-image-url');
        const blogContentInput = document.getElementById('blog-content');
        const cancelEditBlogBtn = document.getElementById('cancel-edit-blog-btn');
        const blogDisplay = document.getElementById('blog-display');
        const blogLoading = document.getElementById('blog-loading');

        // Message Box Elements
        const messageBoxModal = document.getElementById('message-box-modal');
        const messageBoxTitle = document.getElementById('message-box-title');
        const messageBoxContent = document.getElementById('message-box-content');
        const messageBoxOkBtn = document.getElementById('message-box-ok-btn');
        const messageBoxCloseButton = document.querySelector('#message-box-modal .modal-close-button');


        // IMPORTANT: Replace with your actual Google Form embed URL and field IDs
        const GOOGLE_FORM_ENROLLMENT_BASE_URL = "https://docs.google.com/forms/d/e/1FAIpQLSdPNf9oCLYIa3rEbVCoNCGBgEh4DGRdy0XxYxAM5JUWQEWOXA/viewform?embedded=true"; // Example URL
        const GOOGLE_FORM_ENROLLMENT_FIELD_IDS = {
            course: "entry.1828229222",
            studentName: "entry.40854499",
            parentName: "entry.1504263384",
            contactNumber: "entry.605564464",
            email: "entry.352430613",
            message: "entry.341859473"
        };
        const YOUR_CONTACT_GOOGLE_FORM_ACTION_URL = "https://docs.google.com/forms/u/0/d/17FUuG9CCOmfUcsNLVilnCRjT938wU-V8GxIJdhJrKrM/formResponse"; // Replace with your contact form action URL
        const YOUR_NEWSLETTER_GOOGLE_FORM_ACTION_URL = "https://docs.google.com/forms/u/0/d/1X2Blec-M2Ve1qj3AtDndgzcEQOEErAEaF6Loyw_NTLg/formResponse"; // Replace with your newsletter form action URL
        const YOUR_NAME_FIELD_ID = "320465823";
        const YOUR_EMAIL_FIELD_ID = "196734286";
        const YOUR_MESSAGE_FIELD_ID = "1567514947";
        const YOUR_NEWSLETTER_EMAIL_FIELD_ID = "1002277897";

        // --- General Functions ---

        // Function to set the theme and update icon visibility
        function setTheme(theme) {
            if (theme === 'dark') {
                htmlElement.classList.add('dark');
                localStorage.setItem('theme', 'dark');
                sunIcon.classList.add('hidden');
                moonIcon.classList.remove('hidden');
            } else {
                htmlElement.classList.remove('dark');
                localStorage.setItem('theme', 'light');
                sunIcon.classList.remove('hidden');
                moonIcon.classList.add('hidden');
            }
            if (theme === 'dark') {
                document.body.classList.add('dark:bg-gray-900', 'dark:text-gray-100');
                document.body.classList.remove('bg-gray-50', 'text-gray-800');
            } else {
                document.body.classList.remove('dark:bg-gray-900', 'dark:text-gray-100');
                document.body.classList.add('bg-gray-50', 'text-gray-800');
            }
        }

        // SPA Navigation Function
        function renderPage(pageId) {
            pageSections.forEach(section => {
                section.classList.add('hidden');
            });
            const targetSection = document.getElementById(pageId);
            if (targetSection) {
                targetSection.classList.remove('hidden');
                // Scroll to top of the new page
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        }

        // Function to show a custom message box
        function showMessageBox(title, message) {
            messageBoxTitle.textContent = title;
            messageBoxContent.textContent = message;
            messageBoxModal.classList.add('active');
        }

        // Function to hide the custom message box
        function hideMessageBox() {
            messageBoxModal.classList.remove('active');
        }

        // --- Event Listeners and Initial Setup ---
        document.addEventListener('DOMContentLoaded', () => {
            const savedTheme = localStorage.getItem('theme');
            const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;

            if (savedTheme) {
                setTheme(savedTheme);
            } else if (prefersDark) {
                setTheme('dark');
            } else {
                setTheme('light');
            }

            // Initialize accordion
            document.querySelectorAll('.accordion-header').forEach(header => {
                header.addEventListener('click', () => {
                    const contentId = header.dataset.target;
                    const content = document.getElementById(contentId);
                    const icon = header.querySelector('svg');

                    document.querySelectorAll('.accordion-content.active').forEach(otherContent => {
                        if (otherContent.id !== contentId) {
                            otherContent.classList.remove('active');
                            const otherHeader = otherContent.previousElementSibling;
                            if (otherHeader) {
                                const otherIcon = otherHeader.querySelector('svg');
                                if (otherIcon) {
                                    otherIcon.classList.remove('rotate-180');
                                }
                            }
                        }
                    });

                    content.classList.toggle('active');
                    icon.classList.toggle('rotate-180');
                });
            });

            // Handle initial page load based on URL hash
            const initialHash = window.location.hash.substring(1);
            if (initialHash && document.getElementById(initialHash)) {
                renderPage(initialHash);
            } else {
                renderPage('home'); // Default to home page
            }

            // Update navigation links to use renderPage
            navbarLinks.querySelectorAll('a').forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault(); // Prevent default anchor link behavior
                    const pageId = link.getAttribute('href').substring(1);
                    renderPage(pageId);
                    // Close hamburger menu on mobile after clicking a link
                    if (navbarLinks.classList.contains('active')) {
                        navbarLinks.classList.remove('active');
                    }
                });
            });

            // Update form actions for Google Forms
            const contactForm = document.querySelector('#contact form');
            if (contactForm) {
                contactForm.action = YOUR_CONTACT_GOOGLE_FORM_ACTION_URL;
                contactForm.querySelector('#contact-name').name = `entry.${YOUR_NAME_FIELD_ID}`;
                contactForm.querySelector('#contact-email').name = `entry.${YOUR_EMAIL_FIELD_ID}`;
                contactForm.querySelector('#contact-message').name = `entry.${YOUR_MESSAGE_FIELD_ID}`;
            }

            const newsletterForm = document.querySelector('#links form');
            if (newsletterForm) {
                newsletterForm.action = YOUR_NEWSLETTER_GOOGLE_FORM_ACTION_URL;
                newsletterForm.querySelector('#newsletter-email').name = `entry.${YOUR_NEWSLETTER_EMAIL_FIELD_ID}`;
            }
        });

        // Toggle theme on button click
        themeToggle.addEventListener('click', () => {
            if (htmlElement.classList.contains('dark')) {
                setTheme('light');
            } else {
                setTheme('dark');
            }
        });

        // Toggle hamburger menu on click
        hamburgerButton.addEventListener('click', () => {
            navbarLinks.classList.toggle('active');
        });

        // Close hamburger menu when a link is clicked (for smooth scrolling)
        navbarLinks.querySelectorAll('a').forEach(link => {
            link.addEventListener('click', () => {
                if (navbarLinks.classList.contains('active')) {
                    navbarLinks.classList.remove('active');
                }
            });
        });

        // Scroll-to-top button functionality
        window.addEventListener('scroll', () => {
            if (window.scrollY > 300) {
                scrollToTopButton.style.display = 'block';
            } else {
                scrollToTopButton.style.display = 'none';
            }
        });

        scrollToTopButton.addEventListener('click', () => {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        });

        // Enrollment modal functionality
        enrollButtons.forEach(button => {
            button.addEventListener('click', () => {
                const courseName = button.dataset.course;
                modalCourseName.textContent = courseName;
                const formUrl = `${GOOGLE_FORM_ENROLLMENT_BASE_URL}&${GOOGLE_FORM_ENROLLMENT_FIELD_IDS.course}=${encodeURIComponent(courseName)}`;
                enrollmentGoogleFormIframe.src = formUrl;
                enrollmentModal.classList.add('active');
            });
        });

        modalCloseButton.addEventListener('click', () => {
            enrollmentModal.classList.remove('active');
            enrollmentGoogleFormIframe.src = "";
        });

        enrollmentModal.addEventListener('click', (e) => {
            if (e.target === enrollmentModal) {
                enrollmentModal.classList.remove('active');
                enrollmentGoogleFormIframe.src = "";
            }
        });

        // Message Box Event Listeners
        messageBoxOkBtn.addEventListener('click', hideMessageBox);
        messageBoxCloseButton.addEventListener('click', hideMessageBox);
        messageBoxModal.addEventListener('click', (e) => {
            if (e.target === messageBoxModal) {
                hideMessageBox();
            }
        });

        // --- Firebase Authentication Functions ---

        // Listen for auth state changes globally
        onAuthStateChanged(auth, (user) => {
            if (user) {
                userId = user.uid;
                console.log("Auth state changed: User is logged in.", userId);
                checkAdminStatus(user);
            } else {
                userId = 'anonymous';
                isAdmin = false;
                console.log("Auth state changed: User is logged out.");
                updateAdminUI(); // Update UI for logged out state
            }
        });

        // Login with Email and Password
        loginBtn.addEventListener('click', async () => {
            const email = adminEmailInput.value;
            const password = adminPasswordInput.value;
            authMessage.classList.add('hidden');
            if (!email || !password) {
                authMessage.textContent = "Please enter email and password.";
                authMessage.classList.remove('hidden');
                return;
            }
            try {
                const userCredential = await signInWithEmailAndPassword(auth, email, password);
                console.log("Logged in:", userCredential.user.email);
                // checkAdminStatus will be called by onAuthStateChanged listener
            } catch (error) {
                console.error("Login error:", error.message);
                authMessage.textContent = `Login failed: ${error.message}`;
                authMessage.classList.remove('hidden');
            }
        });

        // Login with Google
        googleLoginBtn.addEventListener('click', async () => {
            const provider = new GoogleAuthProvider();
            authMessage.classList.add('hidden');
            try {
                const userCredential = await signInWithPopup(auth, provider);
                console.log("Logged in with Google:", userCredential.user.email);
                // checkAdminStatus will be called by onAuthStateChanged listener
                // If this is a new user, set their role to 'user' by default
                const userDocRef = doc(db, `artifacts/${appId}/public/users/${userCredential.user.uid}`);
                const userDocSnap = await getDoc(userDocRef);
                if (!userDocSnap.exists()) {
                    await setDoc(userDocRef, { role: 'user', email: userCredential.user.email, created_at: new Date() });
                    console.log("New Google user registered with 'user' role.");
                }
            } catch (error) {
                console.error("Google login error:", error.message);
                authMessage.textContent = `Google login failed: ${error.message}`;
                authMessage.classList.remove('hidden');
            }
        });

        // Register with Email and Password
        registerBtn.addEventListener('click', async () => {
            const email = registerEmailInput.value;
            const password = registerPasswordInput.value;
            registerMessage.classList.add('hidden');
            if (!email || !password) {
                registerMessage.textContent = "Please enter email and password.";
                registerMessage.classList.remove('hidden');
                return;
            }
            try {
                const userCredential = await createUserWithEmailAndPassword(auth, email, password);
                console.log("Registered:", userCredential.user.email);
                // Set the role for the new user (default to 'user')
                await setDoc(doc(db, `artifacts/${appId}/public/users/${userCredential.user.uid}`), {
                    role: 'user', // New users are 'user' by default
                    email: userCredential.user.email,
                    created_at: new Date()
                });
                showMessageBox("Registration Successful", "You have successfully registered. You can now log in.");
                // Switch back to login form
                loginFormContainer.classList.remove('hidden');
                registerFormContainer.classList.add('hidden');
                adminEmailInput.value = email; // Pre-fill email for login
                adminPasswordInput.value = '';
                registerEmailInput.value = '';
                registerPasswordInput.value = '';
            } catch (error) {
                console.error("Registration error:", error.message);
                registerMessage.textContent = `Registration failed: ${error.message}`;
                registerMessage.classList.remove('hidden');
            }
        });

        // Logout
        logoutBtn.addEventListener('click', async () => {
            try {
                await signOut(auth);
                console.log("Logged out successfully.");
                showMessageBox("Logged Out", "You have been successfully logged out.");
                // onAuthStateChanged will handle UI update
            } catch (error) {
                console.error("Logout error:", error.message);
                showMessageBox("Logout Error", `Failed to logout: ${error.message}`);
            }
        });

        // Forgot Password
        forgotPasswordBtn.addEventListener('click', async () => {
            const email = adminEmailInput.value;
            if (!email) {
                authMessage.textContent = "Please enter your email to reset password.";
                authMessage.classList.remove('hidden');
                return;
            }
            try {
                await sendPasswordResetEmail(auth, email);
                showMessageBox("Password Reset", `Password reset email sent to ${email}. Please check your inbox.`);
            } catch (error) {
                console.error("Forgot password error:", error.message);
                showMessageBox("Password Reset Error", `Failed to send reset email: ${error.message}`);
            }
        });

        // Toggle between Login and Register forms
        registerToggleBtn.addEventListener('click', () => {
            loginFormContainer.classList.add('hidden');
            registerFormContainer.classList.remove('hidden');
            authMessage.classList.add('hidden'); // Clear login message
            registerMessage.classList.add('hidden'); // Clear register message
            document.getElementById('auth-heading').textContent = "Admin Registration";
        });

        loginToggleBtn.addEventListener('click', () => {
            loginFormContainer.classList.remove('hidden');
            registerFormContainer.classList.add('hidden');
            authMessage.classList.add('hidden'); // Clear login message
            registerMessage.classList.add('hidden'); // Clear register message
            document.getElementById('auth-heading').textContent = "Admin Login";
        });


        // --- Firestore Operations ---

        // Function to create a Firestore collection path based on app ID
        // Note: For a multi-user app where data is private to a user,
        // the path would be `artifacts/${appId}/users/${userId}/${collectionName}`
        // For public data editable by admin, it's `artifacts/${appId}/public/data/${collectionName}`
        function getCollectionRef(collectionName) {
            return collection(db, `artifacts/${appId}/public/data/${collectionName}`);
        }

        // --- Book List Functions ---
        function renderBooks(snapshot) {
            bookListDisplay.innerHTML = ''; // Clear previous content
            if (snapshot.empty) {
                bookListDisplay.innerHTML = '<p class="text-gray-600 dark:text-gray-300 text-center col-span-full">No books added yet.</p>';
            } else {
                snapshot.forEach((doc) => {
                    const book = doc.data();
                    const bookElement = document.createElement('div');
                    bookElement.className = 'bg-white p-6 rounded-xl shadow-lg text-left dark:bg-gray-800 flex flex-col';
                    bookElement.innerHTML = `
                        <h3 class="text-xl font-bold text-gray-900 mb-2 dark:text-gray-100">${book.title}</h3>
                        <p class="text-gray-600 dark:text-gray-300 mb-1"><strong>Author:</strong> ${book.author}</p>
                        <p class="text-gray-600 dark:text-gray-300 mb-2"><strong>Category:</strong> ${book.category}</p>
                        <p class="text-gray-700 dark:text-gray-300 text-sm mb-4 flex-grow">${book.description}</p>
                        ${book.url ? `<a href="${book.url}" target="_blank" rel="noopener noreferrer" class="text-indigo-600 hover:underline dark:text-indigo-400 mt-auto">View Book &rarr;</a>` : ''}
                        ${isAdmin ? `
                            <div class="mt-4 flex space-x-2">
                                <button class="edit-book-btn bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600" data-id="${doc.id}">Edit</button>
                                <button class="delete-book-btn bg-red-500 text-white px-4 py-2 rounded-md hover:bg-red-600" data-id="${doc.id}">Delete</button>
                            </div>
                        ` : ''}
                    `;
                    bookListDisplay.appendChild(bookElement);
                });

                if (isAdmin) {
                    document.querySelectorAll('.edit-book-btn').forEach(button => {
                        button.addEventListener('click', (e) => editBook(e.target.dataset.id));
                    });
                    document.querySelectorAll('.delete-book-btn').forEach(button => {
                        button.addEventListener('click', (e) => deleteBook(e.target.dataset.id));
                    });
                }
            }
            bookListLoading.classList.add('hidden');
        }

        addEditBookForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            if (!isAdmin) {
                showMessageBox("Permission Denied", "You must be logged in as an admin to manage books.");
                return;
            }
            const bookId = bookIdInput.value;
            const bookData = {
                title: bookTitleInput.value,
                author: bookAuthorInput.value,
                category: bookCategoryInput.value,
                description: bookDescriptionInput.value,
                url: bookUrlInput.value || null,
                date_posted: new Date() // Use server timestamp for consistency
            };

            try {
                if (bookId) {
                    // Update existing book
                    await updateDoc(doc(getCollectionRef("books"), bookId), bookData);
                    showMessageBox("Success", "Book updated successfully!");
                } else {
                    // Add new book
                    await addDoc(getCollectionRef("books"), bookData);
                    showMessageBox("Success", "Book added successfully!");
                }
                addEditBookForm.reset();
                bookIdInput.value = ''; // Clear book ID
                cancelEditBookBtn.classList.add('hidden');
                // Data will be re-rendered by the real-time listener
            } catch (e) {
                console.error("Error saving book: ", e);
                showMessageBox("Error", "Error saving book. Please try again.");
            }
        });

        async function editBook(id) {
            if (!isAdmin) {
                showMessageBox("Permission Denied", "You must be logged in as an admin to edit books.");
                return;
            }
            try {
                const docRef = doc(getCollectionRef("books"), id);
                const docSnap = await getDoc(docRef);
                if (docSnap.exists()) {
                    const book = docSnap.data();
                    bookIdInput.value = id;
                    bookTitleInput.value = book.title;
                    bookAuthorInput.value = book.author;
                    bookCategoryInput.value = book.category;
                    bookDescriptionInput.value = book.description;
                    bookUrlInput.value = book.url || '';
                    cancelEditBookBtn.classList.remove('hidden');
                    window.scrollTo({ top: bookListAdminPanel.offsetTop, behavior: 'smooth' }); // Scroll to form
                } else {
                    console.error("No such document!");
                    showMessageBox("Error", "Book not found for editing.");
                }
            } catch (e) {
                console.error("Error fetching document for edit: ", e);
                showMessageBox("Error", "Error fetching book data for editing.");
            }
        }

        cancelEditBookBtn.addEventListener('click', () => {
            addEditBookForm.reset();
            bookIdInput.value = '';
            cancelEditBookBtn.classList.add('hidden');
        });

        async function deleteBook(id) {
            if (!isAdmin) {
                showMessageBox("Permission Denied", "You must be logged in as an admin to delete books.");
                return;
            }
            showMessageBox("Confirm Delete", "Are you sure you want to delete this book?", true, async () => {
                try {
                    await deleteDoc(doc(getCollectionRef("books"), id));
                    showMessageBox("Success", "Book deleted successfully!");
                    // Data will be re-rendered by the real-time listener
                } catch (e) {
                    console.error("Error deleting book: ", e);
                    showMessageBox("Error", "Error deleting book. Please try again.");
                }
            });
        }

        // --- Problems Functions ---
        function renderProblems(snapshot) {
            problemsDisplay.innerHTML = ''; // Clear previous content
            const categories = ["Geometry", "Inequality", "Number Theory", "Calculus", "Algebra"];
            const problemsByCategory = {};
            categories.forEach(cat => problemsByCategory[cat] = []);

            if (snapshot.empty) {
                problemsDisplay.innerHTML = '<p class="text-gray-600 dark:text-gray-300 text-center col-span-full">No problems added yet.</p>';
            } else {
                snapshot.forEach((doc) => {
                    const problem = doc.data();
                    problem.id = doc.id; // Store document ID
                    if (problemsByCategory[problem.category]) {
                        problemsByCategory[problem.category].push(problem);
                    }
                });

                categories.forEach(category => {
                    if (problemsByCategory[category].length > 0) {
                        const categorySection = document.createElement('div');
                        categorySection.className = 'mb-8';
                        categorySection.innerHTML = `
                            <h3 class="text-3xl font-bold text-gray-900 mb-6 dark:text-gray-100 text-center">${category} Problems</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="problems-${category.replace(/\s/g, '-')}-container"></div>
                        `;
                        problemsDisplay.appendChild(categorySection);

                        const container = document.getElementById(`problems-${category.replace(/\s/g, '-')}-container`);
                        problemsByCategory[category].forEach(problem => {
                            const problemElement = document.createElement('div');
                            problemElement.className = 'bg-white p-6 rounded-xl shadow-lg text-left dark:bg-gray-800 flex flex-col';
                            problemElement.innerHTML = `
                                <h4 class="text-xl font-bold text-gray-900 mb-2 dark:text-gray-100">${problem.title}</h4>
                                <p class="text-gray-700 dark:text-gray-300 text-sm mb-4 flex-grow">${problem.description}</p>
                                ${problem.solution_url ? `<a href="${problem.solution_url}" target="_blank" rel="noopener noreferrer" class="text-indigo-600 hover:underline dark:text-indigo-400 mt-auto">View Solution &rarr;</a>` : ''}
                                ${isAdmin ? `
                                    <div class="mt-4 flex space-x-2">
                                        <button class="edit-problem-btn bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600" data-id="${problem.id}">Edit</button>
                                        <button class="delete-problem-btn bg-red-500 text-white px-4 py-2 rounded-md hover:bg-red-600" data-id="${problem.id}">Delete</button>
                                    </div>
                                ` : ''}
                            `;
                            container.appendChild(problemElement);
                        });
                    }
                });

                if (isAdmin) {
                    document.querySelectorAll('.edit-problem-btn').forEach(button => {
                        button.addEventListener('click', (e) => editProblem(e.target.dataset.id));
                    });
                    document.querySelectorAll('.delete-problem-btn').forEach(button => {
                        button.addEventListener('click', (e) => deleteProblem(e.target.dataset.id));
                    });
                }
            }
            problemsLoading.classList.add('hidden');
        }

        addProblemForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            if (!isAdmin) {
                showMessageBox("Permission Denied", "You must be logged in as an admin to manage problems.");
                return;
            }
            const problemId = problemIdInput.value;
            const problemData = {
                title: problemTitleInput.value,
                category: problemCategorySelect.value,
                description: problemDescriptionInput.value,
                solution_url: problemSolutionUrlInput.value || null,
                date_posted: new Date()
            };

            try {
                if (problemId) {
                    // Update existing problem
                    await updateDoc(doc(getCollectionRef("problems"), problemId), problemData);
                    showMessageBox("Success", "Problem updated successfully!");
                } else {
                    // Add new problem
                    await addDoc(getCollectionRef("problems"), problemData);
                    showMessageBox("Success", "Problem added successfully!");
                }
                addProblemForm.reset();
                problemIdInput.value = '';
                cancelEditProblemBtn.classList.add('hidden');
                // Data will be re-rendered by the real-time listener
            } catch (e) {
                console.error("Error saving problem: ", e);
                showMessageBox("Error", "Error saving problem. Please try again.");
            }
        });

        async function editProblem(id) {
            if (!isAdmin) {
                showMessageBox("Permission Denied", "You must be logged in as an admin to edit problems.");
                return;
            }
            try {
                const docRef = doc(getCollectionRef("problems"), id);
                const docSnap = await getDoc(docRef);
                if (docSnap.exists()) {
                    const problem = docSnap.data();
                    problemIdInput.value = id;
                    problemTitleInput.value = problem.title;
                    problemCategorySelect.value = problem.category;
                    problemDescriptionInput.value = problem.description;
                    problemSolutionUrlInput.value = problem.solution_url || '';
                    cancelEditProblemBtn.classList.remove('hidden');
                    window.scrollTo({ top: problemsAdminPanel.offsetTop, behavior: 'smooth' });
                } else {
                    console.error("No such document!");
                    showMessageBox("Error", "Problem not found for editing.");
                }
            } catch (e) {
                console.error("Error fetching document for edit: ", e);
                showMessageBox("Error", "Error fetching problem data for editing.");
            }
        }

        cancelEditProblemBtn.addEventListener('click', () => {
            addProblemForm.reset();
            problemIdInput.value = '';
            cancelEditProblemBtn.classList.add('hidden');
        });

        async function deleteProblem(id) {
            if (!isAdmin) {
                showMessageBox("Permission Denied", "You must be logged in as an admin to delete problems.");
                return;
            }
            showMessageBox("Confirm Delete", "Are you sure you want to delete this problem?", true, async () => {
                try {
                    await deleteDoc(doc(getCollectionRef("problems"), id));
                    showMessageBox("Success", "Problem deleted successfully!");
                    // Data will be re-rendered by the real-time listener
                } catch (e) {
                    console.error("Error deleting problem: ", e);
                    showMessageBox("Error", "Error deleting problem. Please try again.");
                }
            });
        }

        // --- Gallery Functions ---
        function renderGallery(snapshot) {
            galleryDisplay.innerHTML = ''; // Clear previous content
            if (snapshot.empty) {
                galleryDisplay.innerHTML = '<p class="text-gray-600 dark:text-gray-300 text-center col-span-full">No gallery posts yet.</p>';
            } else {
                snapshot.forEach((doc) => {
                    const post = doc.data();
                    const postElement = document.createElement('div');
                    postElement.className = 'relative overflow-hidden rounded-lg shadow-lg group bg-white dark:bg-gray-800';
                    postElement.innerHTML = `
                        <img src="${post.imageUrl}" alt="${post.caption}" class="w-full h-48 object-cover transition-transform duration-300 group-hover:scale-110" loading="lazy" onerror="this.onerror=null;this.src='https://placehold.co/600x400/E0E7FF/4F46E5?text=Image+Not+Found';">
                        <div class="absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                            <p class="text-white text-lg font-semibold px-4">${post.caption}</p>
                        </div>
                        ${isAdmin ? `
                            <div class="absolute bottom-2 right-2 flex space-x-2 opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                                <button class="edit-gallery-btn bg-blue-500 text-white px-3 py-1 rounded-md text-sm hover:bg-blue-600" data-id="${doc.id}">Edit</button>
                                <button class="delete-gallery-btn bg-red-500 text-white px-3 py-1 rounded-md text-sm hover:bg-red-600" data-id="${doc.id}">Delete</button>
                            </div>
                        ` : ''}
                    `;
                    galleryDisplay.appendChild(postElement);
                });

                if (isAdmin) {
                    document.querySelectorAll('.edit-gallery-btn').forEach(button => {
                        button.addEventListener('click', (e) => editGalleryPost(e.target.dataset.id));
                    });
                    document.querySelectorAll('.delete-gallery-btn').forEach(button => {
                        button.addEventListener('click', (e) => deleteGalleryPost(e.target.dataset.id));
                    });
                }
            }
            galleryLoading.classList.add('hidden');
        }

        addGalleryForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            if (!isAdmin) {
                showMessageBox("Permission Denied", "You must be logged in as an admin to manage gallery posts.");
                return;
            }
            const postId = galleryPostIdInput.value;
            const postData = {
                imageUrl: galleryImageUrlInput.value,
                caption: galleryCaptionInput.value,
                date_posted: new Date()
            };

            try {
                if (postId) {
                    // Update existing post
                    await updateDoc(doc(getCollectionRef("gallery_posts"), postId), postData);
                    showMessageBox("Success", "Gallery post updated successfully!");
                } else {
                    // Add new post
                    await addDoc(getCollectionRef("gallery_posts"), postData);
                    showMessageBox("Success", "Gallery post added successfully!");
                }
                addGalleryForm.reset();
                galleryPostIdInput.value = '';
                cancelEditGalleryBtn.classList.add('hidden');
                // Data will be re-rendered by the real-time listener
            } catch (e) {
                console.error("Error saving gallery post: ", e);
                showMessageBox("Error", "Error saving gallery post. Please try again.");
            }
        });

        async function editGalleryPost(id) {
            if (!isAdmin) {
                showMessageBox("Permission Denied", "You must be logged in as an admin to edit gallery posts.");
                return;
            }
            try {
                const docRef = doc(getCollectionRef("gallery_posts"), id);
                const docSnap = await getDoc(docRef);
                if (docSnap.exists()) {
                    const post = docSnap.data();
                    galleryPostIdInput.value = id;
                    galleryImageUrlInput.value = post.imageUrl;
                    galleryCaptionInput.value = post.caption;
                    cancelEditGalleryBtn.classList.remove('hidden');
                    window.scrollTo({ top: galleryAdminPanel.offsetTop, behavior: 'smooth' });
                } else {
                    console.error("No such document!");
                    showMessageBox("Error", "Gallery post not found for editing.");
                }
            } catch (e) {
                console.error("Error fetching document for edit: ", e);
                showMessageBox("Error", "Error fetching gallery post data for editing.");
            }
        }

        cancelEditGalleryBtn.addEventListener('click', () => {
            addGalleryForm.reset();
            galleryPostIdInput.value = '';
            cancelEditGalleryBtn.classList.add('hidden');
        });

        async function deleteGalleryPost(id) {
            if (!isAdmin) {
                showMessageBox("Permission Denied", "You must be logged in as an admin to delete gallery posts.");
                return;
            }
            showMessageBox("Confirm Delete", "Are you sure you want to delete this gallery post?", true, async () => {
                try {
                    await deleteDoc(doc(getCollectionRef("gallery_posts"), id));
                    showMessageBox("Success", "Gallery post deleted successfully!");
                    // Data will be re-rendered by the real-time listener
                } catch (e) {
                    console.error("Error deleting gallery post: ", e);
                    showMessageBox("Error", "Error deleting gallery post. Please try again.");
                }
            });
        }

        // --- Blog Functions ---
        function renderBlogs(snapshot) {
            blogDisplay.innerHTML = ''; // Clear previous content
            if (snapshot.empty) {
                blogDisplay.innerHTML = '<p class="text-gray-600 dark:text-gray-300 text-center col-span-full">No blog posts yet.</p>';
            } else {
                snapshot.forEach((doc) => {
                    const post = doc.data();
                    const postElement = document.createElement('article');
                    postElement.className = 'bg-gray-50 p-6 rounded-xl shadow-lg text-left dark:bg-gray-700 dark:shadow-2xl transition-colors duration-300 ease-in-out flex flex-col';
                    postElement.innerHTML = `
                        <h3 class="text-2xl font-bold text-gray-900 mb-3 dark:text-gray-100">${post.title}</h3>
                        ${post.imageUrl ? `<img src="${post.imageUrl}" alt="${post.title}" class="w-full h-48 object-cover rounded-md mb-4" loading="lazy" onerror="this.onerror=null;this.src='https://placehold.co/600x200/E0E7FF/4F46E5?text=Blog+Image';">` : ''}
                        <p class="text-gray-600 mb-4 dark:text-gray-300 flex-grow">${post.content.substring(0, 150)}...</p>
                        <p class="text-sm text-gray-500 dark:text-gray-400 mb-2">Posted on: ${post.date_posted ? new Date(post.date_posted.seconds * 1000).toLocaleDateString() : 'N/A'}</p>
                        <a href="#" class="text-indigo-600 hover:underline dark:text-indigo-400 mt-auto" aria-label="Read more about ${post.title}">Read More &rarr;</a>
                        ${isAdmin ? `
                            <div class="mt-4 flex space-x-2">
                                <button class="edit-blog-btn bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600" data-id="${doc.id}">Edit</button>
                                <button class="delete-blog-btn bg-red-500 text-white px-4 py-2 rounded-md hover:bg-red-600" data-id="${doc.id}">Delete</button>
                            </div>
                        ` : ''}
                    `;
                    blogDisplay.appendChild(postElement);
                });

                if (isAdmin) {
                    document.querySelectorAll('.edit-blog-btn').forEach(button => {
                        button.addEventListener('click', (e) => editBlogPost(e.target.dataset.id));
                    });
                    document.querySelectorAll('.delete-blog-btn').forEach(button => {
                        button.addEventListener('click', (e) => deleteBlogPost(e.target.dataset.id));
                    });
                }
            }
            blogLoading.classList.add('hidden');
        }

        addBlogForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            if (!isAdmin) {
                showMessageBox("Permission Denied", "You must be logged in as an admin to manage blog posts.");
                return;
            }
            const postId = blogPostIdInput.value;
            const postData = {
                title: blogTitleInput.value,
                imageUrl: blogImageUrlInput.value || null,
                content: blogContentInput.value,
                date_posted: new Date()
            };

            try {
                if (postId) {
                    // Update existing post
                    await updateDoc(doc(getCollectionRef("blog_posts"), postId), postData);
                    showMessageBox("Success", "Blog post updated successfully!");
                } else {
                    // Add new post
                    await addDoc(getCollectionRef("blog_posts"), postData);
                    showMessageBox("Success", "Blog post added successfully!");
                }
                addBlogForm.reset();
                blogPostIdInput.value = '';
                cancelEditBlogBtn.classList.add('hidden');
                // Data will be re-rendered by the real-time listener
            } catch (e) {
                console.error("Error saving blog post: ", e);
                showMessageBox("Error", "Error saving blog post. Please try again.");
            }
        });

        async function editBlogPost(id) {
            if (!isAdmin) {
                showMessageBox("Permission Denied", "You must be logged in as an admin to edit blog posts.");
                return;
            }
            try {
                const docRef = doc(getCollectionRef("blog_posts"), id);
                const docSnap = await getDoc(docRef);
                if (docSnap.exists()) {
                    const post = docSnap.data();
                    blogPostIdInput.value = id;
                    blogTitleInput.value = post.title;
                    blogImageUrlInput.value = post.imageUrl || '';
                    blogContentInput.value = post.content;
                    cancelEditBlogBtn.classList.remove('hidden');
                    window.scrollTo({ top: blogAdminPanel.offsetTop, behavior: 'smooth' });
                } else {
                    console.error("No such document!");
                    showMessageBox("Error", "Blog post not found for editing.");
                }
            } catch (e) {
                console.error("Error fetching document for edit: ", e);
                showMessageBox("Error", "Error fetching blog post data for editing.");
            }
        }

        cancelEditBlogBtn.addEventListener('click', () => {
            addBlogForm.reset();
            blogPostIdInput.value = '';
            cancelEditBlogBtn.classList.add('hidden');
        });

        async function deleteBlogPost(id) {
            if (!isAdmin) {
                showMessageBox("Permission Denied", "You must be logged in as an admin to delete blog posts.");
                return;
            }
            showMessageBox("Confirm Delete", "Are you sure you want to delete this blog post?", true, async () => {
                try {
                    await deleteDoc(doc(getCollectionRef("blog_posts"), id));
                    showMessageBox("Success", "Blog post deleted successfully!");
                    // Data will be re-rendered by the real-time listener
                } catch (e) {
                    console.error("Error deleting blog post: ", e);
                    showMessageBox("Error", "Error deleting blog post. Please try again.");
                }
            } );
        }

        // This function is called after Firebase is initialized and authenticated
        function initializeFirestoreListeners() {
            if (db) {
                // Real-time listener for books
                onSnapshot(query(getCollectionRef("books"), orderBy("date_posted", "desc")), (snapshot) => {
                    renderBooks(snapshot);
                }, (error) => {
                    console.error("Error listening to books collection: ", error);
                    bookListDisplay.innerHTML = '<p class="text-red-500 text-center col-span-full">Error loading books. Please try again.</p>';
                    bookListLoading.classList.add('hidden');
                });

                // Real-time listener for problems
                onSnapshot(query(getCollectionRef("problems"), orderBy("date_posted", "desc")), (snapshot) => {
                    renderProblems(snapshot);
                }, (error) => {
                    console.error("Error listening to problems collection: ", error);
                    problemsDisplay.innerHTML = '<p class="text-red-500 text-center col-span-full">Error loading problems. Please try again.</p>';
                    problemsLoading.classList.add('hidden');
                });

                // Real-time listener for gallery posts
                onSnapshot(query(getCollectionRef("gallery_posts"), orderBy("date_posted", "desc")), (snapshot) => {
                    renderGallery(snapshot);
                }, (error) => {
                    console.error("Error listening to gallery collection: ", error);
                    galleryDisplay.innerHTML = '<p class="text-red-500 text-center col-span-full">Error loading gallery. Please try again.</p>';
                    galleryLoading.classList.add('hidden');
                });

                // Real-time listener for blog posts
                onSnapshot(query(getCollectionRef("blog_posts"), orderBy("date_posted", "desc")), (snapshot) => {
                    renderBlogs(snapshot);
                }, (error) => {
                    console.error("Error listening to blog collection: ", error);
                    blogDisplay.innerHTML = '<p class="text-red-500 text-center col-span-full">Error loading blog posts. Please try again.</p>';
                    blogLoading.classList.add('hidden');
                });

            } else {
                console.warn("Firestore not initialized for real-time listeners.");
            }
        }

    </script>
</body>
</html>
